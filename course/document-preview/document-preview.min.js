!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){"use strict";function t(t){return!t.nodeName||-1!==e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"])}function i(t){return e.isFunction(t)||e.isPlainObject(t)?t:{top:t,left:t}}var o=e.scrollTo=function(t,i,o){return e(window).scrollTo(t,i,o)};return o.defaults={axis:"xy",duration:0,limit:!0},e.fn.scrollTo=function(n,r,a){"object"==typeof r&&(a=r,r=0),"function"==typeof a&&(a={onAfter:a}),"max"===n&&(n=9e9),a=e.extend({},o.defaults,a),r=r||a.duration;var c=a.queue&&a.axis.length>1;return c&&(r/=2),a.offset=i(a.offset),a.over=i(a.over),this.each(function(){function l(t){var i=e.extend({},a,{queue:!0,duration:r,complete:t&&function(){t.call(d,p,a)}});f.animate(g,i)}if(null!==n){var s,u=t(this),d=u?this.contentWindow||window:this,f=e(d),p=n,g={};switch(typeof p){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(p)){p=i(p);break}p=u?e(p):e(p,d);case"object":if(0===p.length)return;(p.is||p.style)&&(s=(p=e(p)).offset())}var w=e.isFunction(a.offset)&&a.offset(d,p)||a.offset;e.each(a.axis.split(""),function(e,t){var i="x"===t?"Left":"Top",n=i.toLowerCase(),r="scroll"+i,v=f[r](),m=o.max(d,t);if(s)g[r]=s[n]+(u?0:v-f.offset()[n]),a.margin&&(g[r]-=parseInt(p.css("margin"+i),10)||0,g[r]-=parseInt(p.css("border"+i+"Width"),10)||0),g[r]+=w[n]||0,a.over[n]&&(g[r]+=p["x"===t?"width":"height"]()*a.over[n]);else{var h=p[n];g[r]=h.slice&&"%"===h.slice(-1)?parseFloat(h)/100*m:h}a.limit&&/^\d+$/.test(g[r])&&(g[r]=g[r]<=0?0:Math.min(g[r],m)),!e&&a.axis.length>1&&(v===g[r]?g={}:c&&(l(a.onAfterFirst),g={}))}),l(a.onAfter)}})},o.max=function(i,o){var n="x"===o?"Width":"Height",r="scroll"+n;if(!t(i))return i[r]-e(i)[n.toLowerCase()]();var a="client"+n,c=i.ownerDocument||i.document,l=c.documentElement,s=c.body;return Math.max(l[r],s[r])-Math.min(l[a],s[a])},e.Tween.propHooks.scrollLeft=e.Tween.propHooks.scrollTop={get:function(t){return e(t.elem)[t.prop]()},set:function(t){var i=this.get(t);if(t.options.interrupt&&t._last&&t._last!==i)return e(t.elem).stop();var o=Math.round(t.now);i!==o&&(e(t.elem)[t.prop](o),t._last=this.get(t))}},o});var module=angular.module("RCP",["ngRoute","ngCookies","ngSanitize","LocalStorageModule"]);module.controller("viewCtrl",["$rootScope","$scope","service",function(e,t,i){t.fid=rcpAid.queryString("fid"),t.mark=rcpAid.queryString("mark"),t.type=rcpAid.queryString("type"),t.count=rcpAid.queryString("count"),t.config={full:"false",zoom:1},t.args={fid:t.fid,mark:t.mark,type:t.type,count:t.count},t.$on("login",function(e,i){return i?void(t.logined=!0):void(t.logined=!1)})}]),module.directive("filePreview",function(){return{template:'<div class="list-main" id="list-main"><div class="view-paper" ng-repeat="paper in paperList" id="{{$index}}"><div class="view-full"><a href="" ng-click="fullScreen()"><i class="image-preview-fullscreen"></i></a></div><img class="view-content" ng-src="{{paper.url}}" default="/course/imgs/preview-err.png" width="100%"></div><div class="view-foot"><div class="foot-tool-bar"><div class="tool-page"><a href="" ng-click="prePage()"><i class="image-preview-prev"></i></a> <input type="text" ng-model="curPage" ng-change="goToPage()"> <span>/{{totalPage}}</span> <a href="" ng-click="nextPage()"><i class="image-preview-next"></i></a></div><div class="tool-list"><a href="" ng-click="zoomIn()"><i class="image-preview-scale-1"></i></a> <a href="" ng-click="zoomOut()"><i class="image-preview-scale-2"></i></a> <a href="" ng-click="fullScreen()"><i class="image-preview-fullscreen"></i></a></div></div></div></div>',restrict:"E",replace:!0,transclude:!0,scope:{config:"=",args:"="},controller:["$rootScope","$scope","$timeout",function(e,t,i){var o=t.config,n=t.args,r="";n.fid?r="fid="+n.fid:n.mark&&(r="mark="+n.mark),t.paperList=[],t.curPage=window.location.hash.replace("#","")||1,t.totalPage=n.count||1;for(var a=0;a<n.count;a++){var c=DYCONFIG.fs.down+"?"+r+"&type="+n.type+"&idx="+a+"&token="+rcpAid.getToken();t.paperList.push({url:c})}i(function(){$("body").scrollTo("#"+(t.curPage-1),200)}),$(window).scroll(function(){$(document).height()-$(window).height();t.$apply(function(){var e=Math.ceil($(window).scrollTop()/$(".view-paper").height());0!=e&&(t.curPage=e)})}),t.fullScreen=function(){o.full?($(".view-paper").width($(window).width()-20),$(".view-content").width($(window).width()-20)):($(".view-paper").width(1e3),$(".view-content").width(1e3)),o.full=!o.full},t.zoomIn=function(){var e=1e3*(o.zoom+.1),t=1e3*(o.zoom+.1);e>=$(window).width()-20?($(".view-paper").width($(window).width()-20),$(".view-content").width($(window).width()-20)):($(".view-paper").width(e),$(".view-content").width(t),o.zoom+=.1)},t.zoomOut=function(){var e=1e3*(o.zoom-.1),t=1e3*(o.zoom-.1);1e3>=e?($(".view-paper").width(1e3),$(".view-content").width(1e3)):($(".view-paper").width(e),$(".view-content").width(t),o.zoom-=.1)},t.goToPage=function(){t.curPage>t.totalPage&&(t.curPage=t.totalPage),t.curPage<1&&(t.curPage=1),i(function(){$("body").scrollTo("#"+(t.curPage-1),200),window.location.hash=t.curPage})},t.nextPage=function(){t.curPage++,t.goToPage()},t.prePage=function(){t.curPage--,t.goToPage()}}]}});