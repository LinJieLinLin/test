var module=angular.module("RCP",["ngCookies"]);if(module.controller("guidanceSpaceCtr",["$scope","service",function(e,a){e.userAvatar="../rcp-common/imgs/face/d-face-1.png",e.unReadNum=function(){return 10},e.$on("login",function(t,s){return s?void(e.userAvatar=s.avatar||e.userAvatar):void a.common.toLogin(!0)}),e.userList=[{type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:100,msgList:[{type:0,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"10:32"}]},{type:1,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:100,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:1,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:99,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:1,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:98,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:9,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:1,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:100,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:100,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:100,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:100,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:100,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:100,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:100,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:100,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:100,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:100,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:100,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:100,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:100,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:100,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:100,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]},{type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:100,msgList:[{type:1,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"昨天"}]}],e.chatUser={type:0,avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"test user name",unread:100,address:"广东省广州市",msgList:[{type:0,message:"这是消息，这是消息，这是消息，重要的是说三遍",time:"10:32"}]},e.currentTab="browse",e.searchLoaded=!0,e.searchList=[{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40},{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40},{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40},{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40},{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40},{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40},{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40},{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40},{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40},{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40},{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40},{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40},{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40},{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40},{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40},{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40},{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40},{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40},{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40},{keyword:"搜索记录",tags:["分类1","分类2"],time:30,price:40}],e.browseLoaded=!0,e.visitList=[{imgUrl:"",title:"花都测试",author:"谢老师",price:0,service:"",category:"",visitTime:200,stayTime:300},{imgUrl:"",title:"花都测试花都测试花都花都测试花都测试花都测试测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300},{imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"花都测试花都测试花都测试",author:"谢老师",price:10,service:["一宗","二中"],category:"",visitTime:200,stayTime:300}],e.curCourseLoaded=!0,e.curCourse={cid:1,detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},e.guessLoaded=!0,e.guessList=[{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]},{detailUrl:"/course/course-detail.html?cid=57319644bc9a34663b579645",imgUrl:"http://fs.dev.gdy.io/6Es3dt==",title:"人教版小学一年级语文课程",author:"谢老师",price:0,join:20,category:["职业教育","IT互联网","后端开发","服务器开发"],service:["职业教育","IT互联网","后端开发","服务器开发"],teachers:[{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"},{avatar:"http://fs.dev.gdy.io/YX6j2t==",name:"我是老师"}]}]}]),module.config(["$provide",function(e){e.decorator("$exceptionHandler",["$delegate",function(e){return function(a,t){e(a,t),console.error({origin:"AngularJS Error",msg:a.message,stack:a.stack}),document.runErrorCallUpgrade()}}])}]),module.controller("mainCtrl",["$scope","$rootScope","$http","service","$cookies","$timeout",function(e,a,t,s,i,n){function r(){var e=localStorage.getItem("anonymousLoginUsr");return e&&"error"!==e?(a.anonymousUser=JSON.parse(e),void(i.stoken=a.anonymousUser.token)):void t({method:"GET",url:"http://"+g_conf.SSO+"/sso/api/anonymousLogin"}).then(function(e){if(0!==e.data.code)return console.error(e.data.msg,"匿名登录失败"),void localStorage.setItem("anonymousLoginUsr","error");var t=e.data.data;t.usr.token=t.token,localStorage.setItem("anonymousLoginToken",t.token),delete t.usr.BAttr,delete t.usr.attrs,localStorage.setItem("anonymousLoginUsr",JSON.stringify(t.usr)),a.anonymousUser=t.usr,i.stoken=t.usr.token},function(e){localStorage.setItem("anonymousLoginUsr","error"),console.error(e,"匿名登录失败")})}function c(t){R.token=rcpAid.getToken(),e.setUserData(UINFO),l(a.currentUser.role),console.log("checkLogin by token")}function o(e){console.log("未登陆",e),rcpAid.isLogin=0,l({}),n(function(){a.$broadcast("login","")},0)}function l(a){function t(a){angular.forEach(a,function(a){var t=!1;angular.forEach(e.itemList,function(e){a.name===e.name&&(t=!0)}),t||e.itemList.push(a)})}function s(){var e=rcpAid.getUrl,a=[];return angular.forEach(arguments,function(t){switch(t){case"学习中心":a.push({ic:"L2",name:t,href:e(t)});break;case"教学中心":a.push({ic:"L2",name:t,href:e(t)});break;case"助学中心":"undefined"==typeof isIE||isIE(9,9)||a.push({ic:"L2",name:t,href:e(t)});break;case"管理中心":a.push({ic:"L1",name:t,href:e(t)});break;case"创建新课程":a.push({ic:"L4",name:t,href:e("创建课程",{type:10})})}}),a}e.itemList=[],angular.forEach(a,function(a,i){switch(i){case"default":break;case"student":e.user.schoolId&&t(s("学校空间")),e.user.classId&&t(s("班级空间"));break;case"parent":t(s("家长空间"));break;case"teacher":e.user.schoolId&&t(s("学校空间")),e.user.classId&&t(s("班级空间"));break;case"help":t(s("助学中心"));break;case"class":t(s("班级空间","学校空间"));break;case"school":t(s("学校空间"));break;case"UCS_ADMIN":t(s("管理中心"));break;case"COURSE_VERIFY_ADMIN":t(s("管理中心"));break;case"PAGE_EDIT_ADMIN":t(s("管理中心"))}}),t(s("学习中心","教学中心","创建新课程","创建新题库"))}function d(){return a.currentUser={},$("body").show(),s.common.checkLogin(c,o),rcpAid.isLogin?void 0:(console.log("未登陆"),void r())}$("body").show();try{R=new ars.ARS,R.args={},R.delay=1e3,R.pushDelay=1e4,R.url=DYCONFIG.ars.rUrl+"pub/api/record",R.token=rcpAid.getToken(),R.start()}catch(g){R={}}e.setUserData=function(e){try{if(console.log(e),!e.uid)return;a.currentUser={uid:e.usr.id,nickName:e.usr.attrs.basic.nickName,avatar:e.usr.attrs.basic.avatar,desc:e.usr.attrs.basic.desc,role:e.usr.attrs.role||""},e.usr.attrs.pass&&(a.currentUser.certification=e.usr.attrs.pass.certification),console.log("发广播",a.currentUser),n(function(){a.$broadcast("login",a.currentUser)},0)}catch(t){console.log(t)}},d()}]),module.factory("course",["request",function(e){var a=DYCONFIG.course.rUrl;return{getCourseDetail:function(t,s){t.token=rcpAid.getToken();var i={method:"GET",url:a+"pub/api/loadCourse",params:t};return e(angular.extend(i,s||{}))},getTeacherCourses:function(t,s){t.token=rcpAid.getToken(),t.isSelf=1;var i={method:"GET",url:a+"pub/api/searchCourse",params:t};return e(angular.extend(i,s||{}))},joinFreeCourse:function(t,s){t.token=rcpAid.getToken();var i={method:"GET",url:a+"usr/api/joinCourse",params:t};return e(angular.extend(i,s||{}))},searchCourse:function(t,s){var i={method:"GET",url:a+"pub/api/searchCourse",params:t};return e(angular.extend(i,s||{}))},verifyCourse:function(t,s){t.token=rcpAid.getToken();var i={method:"GET",url:a+"usr/api/verifyCourse",params:t};return e(angular.extend(i,s||{}))},createCourse:function(t,s,i){t.token=rcpAid.getToken();var n={method:"POST",url:a+"usr/api/createCourse",params:t,data:i};return e(angular.extend(n,s||{}))},getStudentCourse:function(t,s){t.token=rcpAid.getToken(),t.isSelf=10;var i={method:"GET",url:a+"pub/api/searchCourse",params:t};return e(angular.extend(i,s||{}))},releaseCourse:function(t,s){t.token=rcpAid.getToken();var i={method:"GET",url:a+"usr/api/releaseCourse",params:t};return e(angular.extend(i,s||{}))},saveCourseData:function(t,s){var i={};i.token=rcpAid.getToken();var n={method:"POST",url:a+"usr/api/updateCourse",params:i,data:t};return e(angular.extend(n,s||{}))},cancelCourse:function(t,s){t.token=rcpAid.getToken();var i={method:"POST",url:a+"usr/api/cancelCourse",params:t};return e(angular.extend(i,s||{}))},getListGroup:function(t,s){t.token=rcpAid.getToken();var i={method:"GET",url:a+"pub/api/listGroup",params:t};return e(angular.extend(i,s||{}))},getAllTags:function(a,t){a.token=rcpAid.getToken();var s={method:"POST",url:DYCONFIG.pes.rUrl+'pub/api/page/GetPage?keys=[{"key":"p_classifi"}]',params:a};return e(angular.extend(s,t||{}))},updateArticleExt:function(t,s){t.token=rcpAid.getToken();var i={method:"GET",url:a+"usr/api/updateExt",params:t};return e(angular.extend(i,s||{}))},getArticleExt:function(t,s){t.token=rcpAid.getToken();var i={method:"GET",url:a+"pub/api/listArtExt",params:t};return e(angular.extend(i,s||{}))},loadRecord:function(t,s){t.token=rcpAid.getToken();var i={method:"GET",url:a+"pub/api/loadRecord",params:t};return e(angular.extend(i,s||{}))},listPaperCorrect:function(t,s){t.token=rcpAid.getToken();var i={method:"GET",url:a+"usr/api/listPaperCorrect",params:t};return e(angular.extend(i,s||{}))},Publish:function(t,s){t.token=rcpAid.getToken();var i={method:"GET",url:a+"usr/api/publish",params:t};return e(angular.extend(i,s||{}))}}}]),module.run(["service","course",function(e,a){e.expand("course",function(){return a})}]),module.factory("headSearch",["request",function(e){var a=g_conf.pes.rUrl;return{SearchIntelligent:function(t,s){var i={method:"GET",url:a+"pub/api/SearchIntelligent",params:t,option:{loading:!1}};return e(angular.extend(i,s||{}))}}}]),module.run(["service","headSearch",function(e,a){e.expand("headSearch",function(){return a})}]),module.directive("headnav",function(){return{template:'<header><div ng-class="headMaximizeLock ? \'head-maximize\' : \'head-minimize\'"><div ng-class="param.style"><div class="image-head-rainbow decoration-ic"></div><section class="g-m-w header-area"><div class="minimize-logo"><a ng-href="{{param.logo.href||\'/\'}}"><img ng-src="{{param.logo.small}}" alt="{{param.logo.msg}}" title="{{param.logo.msg}}"></a></div><nav class="minimize-nav"><ul><li ng-repeat="item in navList track by $index" ng-class="item.class"><a ng-href="{{item.href || \'\'}}" target="{{item.target || \'_self\'}}">{{item.name}}</a><div ng-if="item.child.length"><ul><li ng-repeat="c in item.child"><a ng-href="{{c.href || \'\'}}" target="{{c.target || \'_self\'}}">{{c.name}}</a></li></ul></div></li></ul></nav><div class="logo"><a ng-href="{{param.logo.href||\'/\'}}"><img ng-src="{{param.logo.large}}" alt="{{param.logo.msg}}" title="{{param.logo.msg}}"></a></div><div class="top-user-menu-bar" ng-class="{clearminw: user.account}"><top-user-menu user="user" item-list="itemList"></top-user-menu></div><div class="h-sc" ng-controller="headSearchCtrl"><div class="head-search-bar"><div class="enter" ng-click="stopPropagation($event)"><input type="text" class="input" ng-model="scText" ng-keydown="onkeydown($event)" ng-change="matchChange(scSelectVal.value,scText)" placeholder="请输入关键词搜索"><div class="match-kw-v" ng-show="matchReadyLock"><div class="mc-list"><ul><li ng-if="!mcCourseList || !mcCourseList.length">暂无相关内容</li><li ng-repeat="item in mcCourseList track by $index" ng-click="intoDetail(item)" ng-if="$index < cMaxLen" ng-class="{hover: $index + lMaxLen == moveKeyIndex}" ng-mouseenter="mouseenter($index, \'资源\')"><div class="text-of pd-r10"><span class="lab" ng-if="item.t == 10">课程</span> <span class="lab" ng-if="item.t == 20">题库</span> <a class="item-name" ng-bind-html="item.name | titleMatchKw:scText"></a></div></li></ul></div></div></div><a ng-click="goToSearch(scSelectVal.value,scText)" class="submit" title="提交"><i class="fa fa-search" aria-hidden="true"></i></a></div><div class="hot-word"><a ng-href="javascript:void(0);" ng-click="goToSort(item.name)" class="mg-r20" ng-repeat="item in scHotWord">{{item.name}}</a></div></div></section><section class="nav-area"><div class="g-m-w"><div class="n-categories" ng-controller="categoriesCtrl" ng-mouseenter="service.mouseenter(hover)" ng-mouseleave="service.mouseleave(hover)"><div class="dt">全部课程</div><div class="dd" id="by-categories" ng-show="categoriesUnfoldLock || hover.mouseEnterLock"><div class="image-giraffe giraffe-icon"></div><div class="dd-inner"><div class="item" ng-repeat="item in categoriesListStyle1 track by $index" ng-mouseenter="service.mouseenter(item)" ng-mouseleave="service.mouseleave(item)" ng-show="$index<5 || hover.mouseEnterLock"><div class="layer"><h3><a ng-href="goToCategory(item.name)" target="_blank" title="{{item.name}}">{{item.name}}</a></h3><div class="hot-word"><a ng-href="goToCategory(item.name,child.name)" target="_blank" class="text-of" ng-repeat="child in item.child track by $index" ng-show="$index<3" title="{{child.name}}">{{child.name}}</a></div><i>&gt;</i></div><div class="sub" ng-show="item.mouseEnterLock"><div class="inner"><dl class="card" ng-repeat="child in item.child track by $index" ng-show="$index<3"><dt><a ng-href="goToCategory(item.name,child.name)" target="_blank" class="f-r">更多&gt;&gt;</a> <a ng-href="goToCategory(item.name,child.name)" target="_blank" title="{{child.name}}">{{child.name}}</a></dt><dd><a ng-href="goToCategory(item.name,child.name,unit.name)" target="_blank" class="text-of" ng-repeat="unit in child.child track by $index" ng-show="$index<15" title="{{unit.name}}">{{unit.name}}</a></dd></dl><div class="more-srot" ng-show="item.child.length>3"><a ng-href="goToCategory(item.name)" target="_blank" class="f-r">更多分类&gt;&gt;</a>. . .</div></div></div></div><div ng-repeat="list in categoriesListStyle2 track by $index"><div class="big-sort"><a ng-href="goToCategory(item.name)" target="_blank" title="{{list.name}}">{{list.name}}</a></div><div class="item" ng-repeat="item in list.child track by $index" ng-mouseenter="service.mouseenter(item)" ng-mouseleave="service.mouseleave(item)"><div class="layer"><h3><a ng-href="goToCategory(list.name,item.name)" target="_blank" title="{{item.name}}">{{item.name}}</a></h3><i>&gt;</i></div><div class="sub" ng-show="item.mouseEnterLock"><div class="inner"><dl class="card" ng-repeat="child in item.child track by $index" ng-show="$index<4"><dt><a ng-href="goToCategory(list.name,item.name,child.name)" target="_blank" class="f-r">更多&gt;&gt;</a> <a ng-href="goToCategory(list.name,item.name,child.name)" target="_blank" title="{{child.name}}">{{child.name}}</a></dt><dd><a ng-href="goToCategory(list.name,item.name,child.name,unit.name)" target="_blank" class="text-of" ng-repeat="unit in child.child track by $index" ng-show="$index<10" title="{{unit.name}}">{{unit.name}}</a></dd></dl><div class="more-srot" ng-show="item.child.length>4"><a ng-href="goToCategory(list.name,item.name)" target="_blank" class="f-r">更多分类&gt;&gt;</a>. . .</div></div></div></div></div></div></div></div><nav class="nav"><a ng-repeat="item in navList track by $index" ng-href="{{item.href || \'\'}}" target="{{item.target || \'_self\'}}" ng-class="item.class">{{item.name}}</a></nav><div class="extra" ng-show=""><a href="javascript:void(0);" class="icf t-icf">名师认证</a> <a href="javascript:void(0);" class="icf e-icf">真实评价</a> <a href="javascript:void(0);" class="icf r-icf">随时退</a></div></div></section></div></div></header>',restrict:"E",replace:!0,transclude:!0,scope:{itemList:"=itemList",user:"=user",nav:"="},controller:["$rootScope","$scope","$element","$attrs","service",function(e,a,t,s,i){a.service=i,a.catType=parseInt(rcpAid.getCourseCat()),e.$watch("headMaximizeLock",function(e){e&&(a.headMaximizeLock=e)}),e.$watch("categoriesUnfoldLock",function(e){e&&(a.categoriesUnfoldLock=e)}),e.$watch("catDomain",function(e){if(e)switch(e){case"aikexue.com":a.init(2)}}),a.$on("login",function(e,t){t&&a.loginInit()}),a.loginInit=function(){3===a.catType&&(a.navList=[{name:"学习中心",href:rcpAid.getUrl("学习中心"),"class":"key",target:"_blank"},{name:"教学中心",href:rcpAid.getUrl("教学中心",{uid:a.user.tid}),"class":"key",target:"_blank"},{name:"高等教育",href:rcpAid.getUrl("分类",{category:"高等教育"}),"class":"key",target:"_blank"}])},a.init=function(e){if("order"===a.nav)return a.navList=[{name:"首页",href:rcpAid.getUrl("首页"),"class":"key"},{name:"个人空间",href:rcpAid.getUrl("学习中心"),"class":"key",target:"_blank"}],void(a.param={logo:{small:"/rcp-common/imgs/order/head-icon.png",large:"/rcp-common/imgs/icon/head-icon.png",href:"/my-order.html",msg:"我的酷校"},style:""});switch(a.catType){case 3:a.isLogin?a.navList=[{name:"学习中心",href:rcpAid.getUrl("学习中心"),"class":"key",target:"_blank"},{name:"教学中心",href:rcpAid.getUrl("教学中心",{uid:a.user.tid}),"class":"key",target:"_blank"},{name:"高等教育",href:rcpAid.getUrl("分类",{category:"高等教育"}),"class":"key",target:"_blank"}]:a.navList=[{
name:"高等教育",href:rcpAid.getUrl("分类",{category:"高等教育"}),"class":"key",target:"_blank"}],a.param={logo:{small:"/rcp-common/imgs/icon/gzmooc-logo.png",large:"/rcp-common/imgs/icon/gzmooc-logo.png",href:DYCONFIG.rcp.rUrl,msg:"酷校 - 首页"},style:""};break;case 2:a.navList=[{name:"首页",href:rcpAid.getUrl("首页"),"class":"key"},{name:"全部课程",href:rcpAid.getUrl("分类"),"class":"key",target:"_blank"},{name:"学习中心",href:rcpAid.getUrl("学习中心"),"class":"key",target:"_blank"}],a.param={logo:{small:"/rcp-common/imgs/icon/aikexue-logo-2.png",large:"/rcp-common/imgs/icon/aikexue-logo.png",href:DYCONFIG.rcp.rUrl,msg:"爱科学"},style:"aikexue-head"};break;default:a.navList=[{name:"首页",href:rcpAid.getUrl("首页"),"class":"key"},{name:"学习中心",href:rcpAid.getUrl("学习中心"),"class":"key",target:"_blank"},{name:"我要吐槽",href:rcpAid.getUrl("我要吐槽"),"class":"key",target:"_blank"}],a.param={logo:{small:"/rcp-common/imgs/icon/book-logo-2.png",large:"/rcp-common/imgs/icon/book-logo.png",href:DYCONFIG.rcp.rUrl,msg:"酷校LOGO·让学习更Cool"},style:""}}},a.init()}]}}),module.directive("topUserMenu",function(){return{template:'<div class="top-user-menu"><div style="font-size:14px;line-height:40px" ng-show="!currentUser.uid"><a ng-href="{{link.login}}" id="login" class="color-cyan pd-l20"><i class="image-login-user-ic"></i>马上登录 </a><span style="color:#ececec;margin:0 8px">| </span><a ng-href="{{link.register}}" class="color-cyan">注册</a></div><div class="menber-link" ng-show="currentUser.uid"><a href="" class="u-info" rel="member_link"><img ng-hide="currentUser.avatar" src="/rcp-common/imgs/face/d-face-1.png" class="face-img" width="40" height="40" rel="user_face" alt="{{currentUser.nickName}}"> <img ng-show="currentUser.avatar" ng-src="{{currentUser.avatar}}" class="face-img" width="40" height="40" rel="user_face" alt="{{currentUser.nickName}}"> <span class="name" rel="user_name" title="{{currentUser.nickName}}" ng-bind="currentUser.nickName"></span> <i class="x-arrow-dowm">&gt;</i></a><div class="u-panel"><div class="tup-box"><div class="tup-info" rel="user_info_box"><div class="user-head" rel="user_face_box"><a ng-href="{{link.setting}}"><img ng-hide="currentUser.avatar" src="/rcp-common/imgs/face/d-face-1.png" width="96" height="96" class="face-img" rel="user_face" alt="{{currentUser.nickName}}"> <img ng-show="currentUser.avatar" ng-src="{{currentUser.avatar}}" width="96" height="96" class="face-img" rel="user_face" alt="{{currentUser.nickName}}"></a></div><div class="user-identity"><p class="user-name text-of"><a href="" rel="user_name" title="{{currentUser.nickName}}" ng-bind="currentUser.nickName"></a></p><p class="attestation-un" ng-class="{\'attestation\':attestation==\'已认证\'}"><i class="image-attestation-yellow"></i> <span>{{attestation}}</span></p></div><div class="clear"></div></div><div class="tup-operate"><div class="card-sets"><a href="{{link.applySpaceUrl}}" class="key f-l"><i class="image-attestation"></i> <span class="text-4f">认证管理</span> </a><a href="{{link.setting}}" target="_blank" class="key f-l"><i class="image-settings"></i> <span class="text-4f">设置</span> </a><a href="" class="key f-r" ng-click="logout()"><i class="image-logout"></i> <span class="text-4f">退出</span></a></div><div class="card-links"><a ng-repeat="item in itemList" ng-href="{{item.href || \'\'}}" ng-class="item.name == \'...\' ? \'disabled key \'+item.icon : \'key \'+item.icon"><i></i> <span>{{item.name}}</span></a></div></div></div></div></div></div>',restrict:"E",replace:!0,transclude:!0,scope:{itemList:"=itemList",user:"=user"},controller:["$rootScope","$scope","$timeout","$location","service",function(e,a,t,s,i){a.$watch("itemList",function(e){if(e){var t=a.itemList.length,s=t%3;if(s)for(var i=3-t%3+t,n=t;i>n;n+=1)e.push({name:"..."})}},!0),a.logout=function(){var e=rcpAid.getUrl("首页");location.href=rcpAid.getUrl("退出",{url:encodeURIComponent(e)})},a.$on("login",function(e,t){t.uid&&a.loginInit()}),a.loginInit=function(){a.currentUser=e.currentUser,a.currentUser.certification&&(a.attestation="已认证")},a.init=function(){var e=rcpAid.getNoTokenUrl();a.link={login:rcpAid.getUrl("登录",{url:encodeURIComponent(e)}),register:rcpAid.getUrl("注册",{url:encodeURIComponent(e)}),applySpaceUrl:rcpAid.getUrl("实名认证"),setting:rcpAid.getUrl("个人设置",{url:window.location.href})},a.attestation="未认证"},a.init()}]}}),module.controller("categoriesCtrl",["$rootScope","$scope","service",function(e,a,t){function s(e){switch(e){case 2:a.categoriesListStyle2=i||[];break;default:a.categoriesListStyle1=i||[]}}a.service=t,a.hover={},a.catType=rcpAid.getCourseCat(),a.byCategories=function(){a.byCategoriesLoading=!0,s(a.catType)},a.listenerMember={byCategories:{node:"#by-categories",callback:a.byCategories}};var i;a.goToCategory=function(){var e=[].slice;return rcpAid.getUrl("分类",{tags:e.call(arguments,0).join(",")})}}]),module.directive("searchDir",function(){return{template:'<div class="h-sc"><div class="head-search-bar"><div class="enter" ng-click="stopPropagation($event)"><input type="text" class="input" ng-model="scText" ng-keydown="onkeydown($event)" ng-change="matchChange(scSelectVal.value,scText)" placeholder="请输入关键词搜索"><div class="match-kw-v" ng-show="matchReadyLock"><div class="mc-list"><ul><li ng-repeat="item in mcCategoryList track by $index" ng-if="$index < lMaxLen" ng-class="{hover: $index == moveKeyIndex}" ng-mouseenter="mouseenter($index,\'类\')" ng-click="matchGoToCategory(item.tag,scText)"><div class="text-of"><a href="javascript:;">{{text}}</a> 在 <a href="javascript:;" class="item-name color-cyan">{{item.tag}}</a> 分类中搜索</div></li></ul><div style="margin:0 10px;border-top:1px solid #dfdfdf" ng-if="mcCourseList.length && mcCategoryList.length"></div><ul><li ng-if="!mcCourseList || !mcCourseList.length">暂无相关内容</li><li ng-repeat="item in mcCourseList track by $index" ng-click="intoDetail(item)" ng-if="$index < cMaxLen" ng-class="{hover: $index + lMaxLen == moveKeyIndex}" ng-mouseenter="mouseenter($index,\'资源\')"><div class="text-of"><span class="lab" ng-if="item.t == 10">课程</span> <span class="lab" ng-if="item.t == 20">题库</span> <a href="javascript:;" class="item-name" ng-bind-html="item.name|titleMatchKw:scText"></a></div></li></ul></div></div></div><a ng-click="goToSearch(scSelectVal.value,scText)" class="submit" title="提交"><i class="fa fa-search" aria-hidden="true"></i></a></div><div class="hot-word"><a href="" class="mg-r20" ng-repeat="item in scHotWord" ng-click="goToSort(item.name)">{{item.name}}</a></div></div>',restrict:"E",replace:!0,transclude:!0,scope:{hot:"="},controller:"headSearchCtrl"}}),module.controller("headSearchCtrl",["$rootScope","$scope","$document","$element","service","headSearch",function(e,a,t,s,i,n){function r(){a.scText="",g()}function c(){k=!0,a.KeyDownIndex=a.moveKeyIndex,d()}function o(){"number"!=typeof a.moveKeyIndex?a.moveKeyIndex=0:a.moveKeyIndex=(a.moveKeyIndex+1)%a.aMaxLen,c()}function l(){"number"!=typeof a.moveKeyIndex?a.moveKeyIndex=a.aMaxLen-1:a.moveKeyIndex=a.moveKeyIndex<0?a.aMaxLen-1:a.moveKeyIndex-1,c(),p(a.scText.length)}function d(){var e,t=a.KeyDownIndex,s=a.lMaxLen;return a.scTag=void 0,s>t&&(a.scText=a.text),t>=s&&(e=a.mcCourseList[t-a.lMaxLen],e&&(a.scText=e.name)),e}function g(e){a.matchReadyLock=!1,e&&(t.unbind("click"),a.$digest())}function u(){t.unbind("click").bind("click",function(){g("digest")}),a.matchReadyLock=!0}function h(){a.matchReadyLock&&(clearTimeout(w),w=setTimeout(function(){g("digest")},300))}function p(e){var a=s.find('input[ng-model="scText"]').get(0);if("selectionStart"in a&&(a.selectionStart=e,a.selectionEnd=e),"createTextRange"in a){var t=a.createTextRange();t.moveStart("character",e),t.collapse(!0),t.select()}}function m(e,t){a.inSort&&!angular.isArray(e)||angular.forEach(e,function(e){return a.inSort?!1:void(t(e)||angular.isArray(e.child)&&e.child.length&&(m(e.child,t),f("push",e.name)))})}function v(e,t){switch(a.inSort=!1,f("clear"),m(e,function(e){return a.inSort=e.name===t,a.inSort&&f("push",e.name),a.inSort}),a.inSort){case!0:f("splice",t);break;default:f("clear")}return a.categorySelect}function f(e,t){var s=a.categorySelect;switch(e){case"clear":s.splice(0,s.length);break;case"push":s.push(t);break;case"splice":s.splice(0,$.inArray(t,s))}}function y(e,a){i.dialog.alert(a),console[e](a)}function b(e){var a=[];if(e.length)for(var t=0,s=e.length;s>t;t++)a.push({id:e[t].hasOwnProperty("id")?e[t].id:"",name:e[t].hasOwnProperty("title")?e[t].title:"",t:e[t].hasOwnProperty("type")?e[t].type:""});return a}a.scHotWord=[],a.scSelect=[{name:"所有分类",value:"",fixLock:!0},{name:"课程",value:10},{name:"题库",value:20}],a.scSelectVal=a.scSelect[0],a.onkeydown=function(e){switch(e.stopPropagation(),e.keyCode){case 13:a.scText||(a.scText=$(".head-search-bar input").eq(0).val());var t=a.KeyDownIndex,s=a.lMaxLen;"number"==typeof t&&t>=0&&s>t&&a.scTag?a.matchGoToCategory(a.scTag,a.scText):t>=0&&a.matchReadyLock?location.href=rcpAid.getUrl("课程详情",{cid:a.mcCourseList[t].id}):a.goToSearch(a.scSelectVal.value,a.scText);break;case 38:l();break;case 40:o();break;default:k=!1,a.moveKeyIndex=void 0,a.KeyDownIndex=void 0,a.scTag=void 0}};var k,w;s.find('input[ng-model="scText"]').unbind("focus").bind("focus",u),s.find('input[ng-model="scText"]').unbind("blur").bind("blur",h),a.mouseenter=function(e,t){switch(t){case"类":a.moveKeyIndex=e;break;case"资源":a.moveKeyIndex=e+a.lMaxLen}},a.goToSearch=function(e,a){r(),location.href=rcpAid.getUrl("搜索",{type:e,query:a?encodeURIComponent(a):a})},a.goToSort=function(e){r(),location.href=rcpAid.getUrl("分类",{tags:e})},a.stopPropagation=function(e){e.stopPropagation()},a.matchChange=function(e,t){if(!k){if(g(),!t)return a.mcCategoryList=[],void(a.mcCourseList=[]);a.text=t,n.SearchIntelligent({key:t,courseType:e||null,limit:10}).then(function(e){a.scText&&(a.matchReadyLock=!0,a.mcCourseList=b(e.data.courses||[]),a.mcCategoryList=[],a.lMaxLen=a.mcCategoryList.length>3?3:a.mcCategoryList.length,a.cMaxLen=a.mcCourseList.length-a.lMaxLen,a.aMaxLen=a.lMaxLen+a.cMaxLen,a.mcCourseList.length||a.mcCategoryList.length||g())},function(e){y("错误代码："+e.data.data.code)})}},a.$watch("scSelectVal.value",function(){a.matchChange(a.scSelectVal.value,a.scText)}),a.matchGoToCategory=function(a,t){if(!e.allTagCategroy||!e.allTagCategroy.length)return void y("error","获取分类数据失败");var s=v(e.allTagCategroy,a).reverse().join(",");s?(r(),location.href=rcpAid.getUrl("分类",{tags:s,query:t})):y("error","找不到这个分类，请检查接口数据")},a.categorySelect=[],a.intoDetail=function(e){e.hasOwnProperty("id")&&(location.href=rcpAid.getUrl("课程详情",{cid:e.id}))}}]),module.directive("tailnav",function(){return{template:'<footer><section class="footer" id="footer"><div class="g-m-w"><div class="copyright"><p>广州市大洋信息技术股份有限公司 版权所有</p><p>Copyright © 2015 ITDAYANG. All Rights Reserved.</p><p>{{caseNumber}}</p></div><div class="footer-link"><a href="http://www.itdayang.com/about.html" target="_blank">关于我们</a> <span>- </span><a href="http://www.itdayang.com/contact.html" target="_blank">联系我们</a> <span>- </span><a href="javascript:;" ng-click="atBuilding()">法律条款</a> <span>- </span><a href="javascript:;" ng-click="atBuilding()">帮助中心</a> <span>- </span><a href="javascript:;" ng-click="atBuilding()">学校申请加入</a> <span>- </span><a href="javascript:;" ng-click="atBuilding()">机构申请加入</a> <span>- </span><a href="javascript:;" ng-click="atBuilding()">意见反馈</a></div><div class="clear"></div></div></section></footer>',restrict:"E",replace:!0,transclude:!0,scope:{data:"=data"},controller:["$scope","service",function(e,a){e.catType=rcpAid.getCourseCat();var t=DYCONFIG.domain||[];angular.forEach(t,function(a){a.domain===location.host&&(e.caseNumber=a.domainNum)}),e.atBuilding=function(){a.dialog.alert("正在建设中...")}}]}}),module.filter("titleMatchKw",["$sce",function(e){return function(a,t){var s="<b>"+t+"</b>",i=/([\[\]\(\)\{\}\*\?\+\^\$\.\|\\])/gi,n=t.replace(i,"\\$1");return a=a.replace(new RegExp(n,"ig"),s),e.trustAsHtml(a)}}]),function(){function e(){var i=document.getElementById("footer");if(i){var n=document.documentElement.scrollHeight-1||document.body.scrollHeight-1,r=document.documentElement.clientHeight||document.body.clientHeight;s=r>=n?1:2,s!==t&&(r>=n?(a(i.parentNode,{height:i.offsetHeight+"px"}),a(i,{position:"absolute",width:"100%",bottom:0,left:0})):(a(i.parentNode,{height:i.offsetHeight+"px"}),a(i,{position:"",width:"100%",bottom:0,left:0}))),t=r>=n?1:2}setTimeout(e)}if(!window.fixedFooterFlag){window.fixedFooterFlag=!0;var a=function(e,a){for(k in a)e.style[k]=a[k]},t=0,s=1;e()}}(),function(){var e=angular.module("chat_directive",[]);e.filter("orderObjectBy",function(){return function(e,a){var t=[];return angular.forEach(e,function(e){t.push(e)}),t.sort(function(e,t){return e[a]>t[a]?1:-1}),t}});var a=g_conf;e.controller("chat",["$scope","$q","$rootScope","$http","$cookies","chatService","service",function(e,t,s,i,n,r,c){function o(e){var a=!1;return angular.forEach(m,function(t){e===t.id&&(a=!0)}),a}function l(e){return r.http.getAnswerTeacher(e).then(function(e){var a={name:e.data.name,img:e.data.img,uuid:e.data.uuid,type:"user",id:e.data.id,online:e.data.online};return a})}function d(){e.addMenu=!1,e.$digest(),angular.element(document).off("click",d)}function g(){return r.http.getGuideTeacher().then(function(a){var t={name:a.data.name,img:a.data.img,uuid:a.data.uuid,type:"user",id:a.data.id,online:a.data.online};return e.guideTeacher=t,e.guideTeacher})}function u(a){switch(a){case"serve":e.tabName="找老师";break;case"group":e.tabName="群组";break;case"friend":e.tabName="好友";break;default:e.tabName="消息"}}e.isIE9=!1,isIE(9,9)&&(e.isIE9=!0),angular.element(".online-chat").show();var h=r.util.devlog,p=r.util.log;e.unread=r.api.unread,e.chatTarget=null,e.self=r.data.self,e.unreadMsgList=r.data.unreadMsgList,e.myCourse=r.data.serveList,e.show="main";var m=[];angular.forEach(r.data.groups,function(e){"DEFAULT"===e.type&&(m=e.users)}),e.loginStatus="pending",e.changeUploadType=r.api.changeUploadType,r.on("wsConnected",function(){e.loginStatus="pending"}).on("wsLogined",function(){h("login to server successfully"),e.loginStatus="logined"}).on("wsLoginError",function(){h("即时通讯登陆失败，使用匿名登陆。")}).on("wsMsg",function(a,t){var s,i;"G"===a.a[0]?(s=+a.a.split("-")[1],i=a.a):(s=+a.s.split("-")[1],i=a.s),e.chatTarget&&e.chatTarget.uuid===i&&e.$emit("scrollToBottom"),h("recieve msg from id "+s,t),e.$emit("loadMsg")}).on("openChatWindow",function(a){e.readyToOpenWindow?(e.showChatWindow=!0,e.openChatWindow(a)):e.$watch("readyToOpenWindow",function(t){t&&(e.showChatWindow=!0,e.openChatWindow(a))})}).on("openAddFriendDialog",function(a){return o(a._id||a.id)?(r.util.log("该用户已经是您的好友。"),!1):a._id&&a._id===e.self.id||a.id&&a.id===e.self.id?void r.util.log("不能添加自己为好友。"):(e.showAddDialog=!0,void(e.addTarget=a))}),e.unreadAll=function(){var e=0;for(var a in r.api.unread)r.api.unread.hasOwnProperty(a)&&(e+=r.api.unread[a]);return e},e.closeAddDialog=function(){e.showAddDialog=!1,e.msg=""},e.requestAddFriend=function(){return e.addTarget?void r.http.requestFriend({uuid:e.addTarget.uuid,msg:e.msg}).then(function(){r.util.log("好友申请成功！"),e.showAddDialog=!1,e.msg=""},function(a){1===a.type?(2===a.data.data.code&&(e.showAddDialog=!1,e.msg=""),r.util.log(a.data.data.msg)):(r.util.log("请求添加好友失败！"),r.util.devlog(a))}):void r.util.log("请选择需要添加为好友的用户。")};var v=s.$watch("loginStatusInit",function(a){function i(){if(a.flag)return h("already logined, get current user info and group list"),r.api.changeToken(rcpAid.getToken()),r.api.getMyInfoAndGroup();h("not login, use anonymous login");var e=t.defer();return s.$watch("anonymousUser",function(a){a&&(r.api.changeToken(a.token),h("get anonymous user info"),r.api.getMyInfoAndGroup().then(function(){e.resolve()},function(){return r.http.anonymousLogin().then(function(a){if(0!==a.code)return console.error(a.msg,"匿名登录失败"),void localStorage.setItem("anonymousLoginUsr","error");var t=a.data;t.usr.token=t.token,localStorage.setItem("anonymousLoginToken",t.token),delete t.usr.BAttr,delete t.usr.attrs,localStorage.setItem("anonymousLoginUsr",JSON.stringify(t.usr)),s.anonymousUser=t.usr,n.stoken=t.usr.token,r.api.changeToken(t.usr.token),r.api.getMyInfoAndGroup().then(function(){e.resolve()},function(a){e.reject(a)})},function(a){localStorage.setItem("anonymousLoginUsr","error"),e.reject(a)})}))},!0),e.promise}if(a)return v(),e.hasUserLogin=a.flag,e.isTeacher=e.hasUserLogin&&1===s.currentUser.auth,e.isHelpTeacher=e.hasUserLogin&&-1!==s.currentUser.roleArr.indexOf("HELP"),jf.isIE()&&jf.isIE()<10?void(e.chatError="浏览器版本过低"):void i().then(function(){return h("get current user recent chat list"),r.api.getRecentUser()}).then(function(){return h("initialize upload plugin"),r.api.initUploadPlugin("chat-img-upload","image").then(function(){return r.api.initUploadPlugin("chat-file-upload","file")})}).then(function(){return h("initialize websocket, and login to server"),r.ws.init()}).then(function(){return e.readyToOpenWindow=!0,h("ready to open chat window"),r.api.getOfflineMsg()}).then(function(){return r.api.getFriendRequest()}).then(function(){return r.api.getServeList()}).then(function(){r.trigger("loadFriendNotify"),r.api.initTextInput(angular.element("#msg-content"))},function(a){1===a.type?r.util.log(a.data.data.msg):r.util.log("初始化即时通讯组件失败！网络错误！"),e.chatError=a,h("err",a)})},!0);e.openChatWindow=function(a){if(a){if(a.uuid===e.self.uuid)return p("不能与自己聊天。"),!1;e.show="main",e.activeTab="msg",e.chatTarget=a,e.chatType=a.type,r.trigger("enterChat",e.chatTarget),r.trigger("chatWindow",!0),r.trigger("openRecord")}},e.enterChat=function(a){e.show="main",r.trigger("switchTab","msg"),r.util.popUpUser(a.uuid),r.trigger("openChatWindow",a),e.activeTab="msg"},e.showLoginWindow=function(){c.loginModal?c.loginModal.show():"undefined"!=typeof loginWinService&&loginWinService.show()},e.findTeacher=function(a){var t=!1,s=[];for(var i in a)a.hasOwnProperty(i)&&(t=!0,s.push(a[i].uuid));return t?void l(s.join(",")).then(function(a){e.enterChat(a)},function(e){1===e.type?r.util.log(e.data.data.msg):r.util.log("请求答疑老师失败！网络错误！")}):void r.util.log("该课程没有答疑老师.")},e.open=function(a,t){if(!a&&e.showChatWindow)return void e.close();if("/course-detail.html"===location.pathname){var s=angular.element(".course-intro").scope();s.course&&r.util.request({url:"/smap",method:"POST",params:{key:e.self.id+"_CUR_COURSE",val:JSON.stringify(s.course)}}).then(function(e){console.log(e)})}return t||e.hasUserLogin?void r.trigger("openChatWindow",a||r.data.recentUser[0]):void e.switchTab("guide")},e.close=function(){e.showChatWindow=!1,e.chatTarget=void 0,r.trigger("closeChat")},e.showAddMenu=function(){e.addMenu=!0,setTimeout(function(){angular.element(document).on("click",d)},100)},e.addFriend=function(){r.trigger("resetAddGroup"),e.show="addFriend",e.tabName="添加好友",setTimeout(function(){angular.element(".chat-search-name").focus()},10)},e.addGroup=function(){e.show="addGroup",e.tabName="创建讨论组"},e.activeTab="msg",e.tabName="消息",e.switchTab=function(a){u(a),"guide"===a?g().then(function(e){r.trigger("switchTab","msg"),r.trigger("openChatWindow",e)},function(e){1===e.type?r.util.log(e.data.data.msg):r.util.log("查找在线客服失败！网络错误！")}):(r.trigger("switchTab",a),e.chatTarget=null,r.trigger("closeChat"),e.activeTab=a),"serve"===a?e.show="serve":e.show="main"},c.httpConfig&&c.httpConfig.filter("loading",[a.friendsAddr,a.rdisAddrSrv],!1)}]),e.directive("chat",function(){var e={template:'<div><div class="online-chat" ng-class="{\'online-chat-left\': position == \'left\'}" ng-controller="chat" ng-hide="isIE9"><div ng-hide="showChatWindow" class="chat-login" ng-mouseover="active=true" ng-mouseleave="active=false;"><span ng-show="unreadAll() > 0" class="chat-unread">{{unreadAll() > 99 ? \'99+\' : unreadAll()}}</span> <button type="button" class="chat-btn chat-rel" ng-hide="loginStatus==\'pending\' || loginStatus==\'logined\' && !readyToOpenWindow" ng-click="open()"><span class="chat-login-icon chat-dis-inlineblock" ng-class="{\'image-chat\': !active, \'image-chat-active\': active}"></span> <span ng-hide="unreadMsgList.length">{{hasUserLogin ? \'在线聊天\' : \'亲，需要帮助吗？\'}}</span> <span ng-show="unreadMsgList.length" class="chat-msg-tips" title="{{unreadMsgList[0].message}}"><span>{{unreadMsgList[0].sender.name}}：</span><span>{{unreadMsgList[0].message}}</span></span></button> <button type="button" class="chat-btn chat-rel" ng-show="loginStatus==\'pending\'"><span class="chat-login-icon chat-dis-inlineblock" ng-class="{\'image-chat\': !active, \'image-chat-active\': active}"></span> <span ng-show="chatError">初始化失败</span> <span ng-show="!chatError">登陆中</span></button> <button type="button" class="chat-btn chat-rel" ng-show="loginStatus==\'logined\' && !readyToOpenWindow"><span class="chat-login-icon chat-dis-inlineblock" ng-class="{\'image-chat\': !active, \'image-chat-active\': active}"></span> 连接中</button></div><div class="chat-window" ng-show="showChatWindow" drag=".chat-head" position="fixed" limit="true"><div class="chat-main-body chat-abs"><ul class="chat-menu chat-abs"><li><a href=""><span class="chat-avatar"><img ng-src="{{self.img}}" alt=""> </span><span class="chat-online"></span></a></li><li class="chat-rel" title="消息" ng-mouseenter="msgHover=true" ng-mouseleave="msgHover=false" data="{{activeTab}}"><a ng-click="switchTab(\'msg\')" href="" ng-class="{\'chat-active\': msgHover || activeTab==\'msg\'}"><span class="chat-menu-icon" ng-class="{\'image-chat-msg-active\': msgHover || activeTab==\'msg\', \'image-chat-msg\':!msgHover && activeTab!=\'msg\'}"></span>消息</a> <span ng-show="unreadAll() > 0" class="chat-unread">{{unreadAll() > 99 ? \'99+\' : unreadAll()}}</span></li><li title="找老师" ng-mouseenter="serveHover=true" ng-mouseleave="serveHover=false"><a ng-click="switchTab(\'serve\')" href="" ng-class="{\'chat-active\': serveHover || activeTab==\'serve\'}"><span class="chat-menu-icon" ng-class="{\'image-chat-serve-active\': serveHover || activeTab==\'serve\', \'image-chat-serve\':!serveHover && activeTab!=\'serve\'}"></span>找老师</a></li><li title="找客服" ng-mouseenter="guideHover=true" ng-mouseleave="guideHover=false" ng-hide="isHelpTeacher"><a ng-click="switchTab(\'guide\')" href="" ng-class="{\'chat-active\': guideHover || activeTab==\'guide\'}"><span class="chat-menu-icon" ng-class="{\'image-chat-guide-active\': guideHover || activeTab==\'guide\', \'image-chat-guide\':!guideHover && activeTab!=\'guide\'}"></span>找客服</a></li><li title="群组" ng-mouseenter="groupHover=true" ng-mouseleave="groupHover=false"><a ng-click="switchTab(\'group\')" href="" ng-class="{\'chat-active\': groupHover || activeTab==\'group\'}"><span class="chat-menu-icon" ng-class="{\'image-chat-group-active\': groupHover || activeTab==\'group\', \'image-chat-group\':!groupHover && activeTab!=\'group\'}"></span>群组</a></li><li title="好友" ng-mouseenter="friendHover=true" ng-mouseleave="friendHover=false"><a ng-click="switchTab(\'friend\')" href="" ng-class="{\'chat-active\': friendHover || activeTab==\'friend\'}"><span class="chat-menu-icon" ng-class="{\'image-chat-friend-active\': friendHover || activeTab==\'friend\', \'image-chat-friend\':!friendHover && activeTab!=\'friend\'}"></span>好友</a></li><li ng-mouseenter="menuHover=true" ng-mouseleave="menuHover=false"><a ng-click="showAddMenu()" href=""><span class="chat-menu-icon" ng-class="{\'image-chat-menu-active\': menuHover, \'image-chat-menu\':!menuHover}"></span></a><div ng-show="addMenu" class="chat-add-menu chat-abs"><a href="" ng-click="addFriend()">添加好友</a> <a href="" ng-click="addGroup()">创建讨论组</a></div></li></ul><div class="chat-right-content"><div class="chat-head chat-abs"><p>{{tabName}}</p><button class="chat-btn icon-close chat-abs" ng-click="close()"></button></div><div ng-show="show===\'main\'" class="chat-user-list chat-abs" ng-controller="chatContact"><div class="chat-user-search"><input type="text" ng-focus="focusSearchInput()" ng-change="changeSearchInput()" ng-model="searchUser" ng-keydown="enterSearchUser($event)"> <button ng-click="searchUserResult()" class="icon-magnifier chat-btn"></button></div><div ng-if="activeTab==\'friend\' || activeTab==\'group\'" class="chat-content-wrapper chat-scrollbar"><div ng-show="hasUserLogin" class="chat-groups"><div class="chat-friends" ng-repeat="group in groups|orderObjectBy:\'order\'" ng-if="(activeTab==\'friend\' && friendGroupList.indexOf(group.type)!=-1) || (activeTab==\'group\'&&groupGroupList.indexOf(group.type)!=-1)" ng-hide="group.name === \'我的学生\' && !isTeacher"><div class="chat-group-name"><a href="" ng-click="group.expand=!group.expand"><span class="fa" ng-class="{\'fa-angle-down\': group.expand, \'fa-angle-right\':!group.expand}"></span> <span>{{group.name}}</span> <span class="chat-group-count" ng-if="activeTab==\'friend\'">{{onlineCount(group.users)}}/{{group.users.length}}</span> <span class="chat-group-count" ng-if="activeTab==\'group\'">{{group.users.length}}</span></a></div><div ng-show="group.expand"><ul class="chat-group-list"><li ng-class="{\'chat-current\': user.uuid==chatTarget.uuid}" ng-repeat="user in group.users" ng-hide="hideUnrelativeItem(user.name)"><a href="" ng-click="showUserDetail(user)"><span class="chat-avatar"><img ng-src="{{user.img}}" alt="" ng-class="{\'grayscale\': !user.online}"> </span><span class="chat-user-name" title="{{user.name}}">{{user.name}}</span> </a><span ng-show="unread[user.uuid] > 0" class="chat-unread">{{unread[user.uuid] > 99 ? \'99+\' : unread[user.uuid]}}</span></li></ul></div></div></div><div ng-show="!hasUserLogin" class="chat-login-tips chat-abs chat-center"><p style="font-size:16px">( ▼-▼ )</p><p style="font-size:16px;margin-bottom:10px">什么也没有</p><p>登录后体验更多</p><p><a href="" ng-click="showLoginWindow()">马上登录</a></p></div></div><div ng-if="activeTab==\'msg\'" class="chat-content-wrapper chat-scrollbar"><ul class="chat-group-list chat-msg-list"><li ng-class="{\'chat-current\': (user.uuid==chatTarget.uuid) || (showFriendRequest && user.uuid===\'U-0\')}" ng-repeat="user in recentUser" ng-mouseenter="user.showClose=true" ng-mouseleave="user.showClose=false" ng-hide="hideUnrelativeItem(user.name)"><button ng-click="deleteRecentChat(user, $index)" ng-show="user.showClose" class="chat-delete-window"><span class="icon-close"></span></button> <a href="" ng-click="openChatWindow(user)"><span class="chat-avatar"><img ng-src="{{user.img}}" alt="" ng-class="{\'grayscale\': !user.online}"> </span><span class="chat-user-name" title="{{user.name}}">{{user.name}}</span> </a><span ng-show="unread[user.uuid] > 0" class="chat-unread">{{unread[user.uuid] > 99 ? \'99+\' : unread[user.uuid]}}</span></li><p ng-show="!recentUser.length" style="margin:50px 0;text-align:center;color:#ccc">暂无最近联系人。</p></ul></div></div><div ng-show="show===\'main\'" class="chat-content" ng-controller="chatContent"><div ng-show="showMain" class="chat-main chat-center" ng-class="{\'chat-record-open\': showMsgRecord}"><div class="chat-header chat-drag"><span class="chat-target-name" title="{{chatTarget.name}}">{{chatTarget.name}}</span> <a href="" ng-click="addFriend(chatTarget)" class="image-chat-friend-add chat-abs chat-friend-add" ng-show="showAddFriendBtn && hasUserLogin"></a> <a href="" ng-click="showGroupDetail(chatTarget)" class="image-chat-group chat-abs chat-friend-add" ng-show="chatType==\'group\'"></a></div><div class="chat-body chat-abs"><div class="chat-body-left chat-center"><div class="chat-history chat-scrollbar"><ul><div ng-hide="loadingMsg || noMoreMsg" class="chat-show-more"><a href="" ng-click="loadMoreMsg()"><span class="fa fa-clock-o"></span>查看更多消息</a></div><div ng-show="loadingMsg" class="chat-show-more"><span class="fa fa-spinner fa-spin"></span>正在载入</div><chat-msg chat-type="chatType" index="{{$index}}" ng-repeat="msg in currentChatMsg" msg="msg" id="msg-{{currentChatMsg.length - $index}}"></chat-msg></ul></div><a ng-show="unreadMsg>0" class="chat-unread-msg" ng-click="showNewMsg()">您有 <span>{{unreadMsg}}</span> 条新消息</a><div class="chat-editor"><div class="chat-editor-helper chat-rel"><a href="" ng-click="selectUploadFile(2)"><span class="icon-polaroid"></span> </a><a href="" ng-click="selectUploadFile(3)"><span class="icon-sent-files"></span> </a><a href="" ng-class="{\'chat-btn-opened\': showMsgRecord}" ng-click="openMsgRecord()" class="chat-open-record chat-abs"><span class="fa fa-clock-o"></span> 消息记录 </a><input type="file" id="chat-img-upload" style="display:none" accept="image/*"> <input type="file" id="chat-file-upload" style="display:none" accept="*"></div><div class="chat-editor-input"><textarea name="" id="msg-content" cols="30" rows="10" ng-model="msg" ng-keydown="typeMsg($event)"></textarea></div><div class="chat-send"><button class="chat-btn" ng-show="self.name === \'superone\'" ng-click="autoSendMsg(1000)">发送1000条消息</button> <button ng-click="endChat()" class="chat-btn">结束</button> <button class="chat-btn chat-btn-active" ng-click="send()">发送</button></div></div></div></div><div class="chat-msg-record chat-dis-inlineblock" ng-show="showMsgRecord" ng-controller="record"><div class="chat-record-head chat-dis-inlineblock"><span>消息记录</span> <button class="chat-btn" ng-click="$parent.openMsgRecord()">&times;</button></div><div class="chat-record-body chat-scrollbar"><ul class="chat-record-list" ng-class="{\'chat-record-list-pd\': showSearch}"><li ng-repeat="msg in record" ng-hide="loading" ng-class="{\'chat-msg-mine\': msg.sender.id == self.id}" class="pd-x10 mg-y10"><p class="chat-record-day" ng-show="showDay($index)">{{msg.day}}</p><span class="chat-record-name">{{msg.sender.name}}</span> <span class="chat-record-time mg-l10">{{msg.time}}</span><div class="chat-record-content mg-t5" ng-bind-html="msg.msg|html" ng-hide="msg.fileType===2"></div><div class="chat-record-content mg-t5" msg-img="msg" ng-if="msg.fileType===2"></div></li><div ng-show="!record.length && !loading" style="padding:50px 0;text-align:center;color:#ccc"><span class="image-chat-record-empty chat-dis-inlineblock mg-b20"></span><p ng-if="date==today&&recordDate">亲，您今天还没跟 <span>{{chatTarget.name}}</span> 交流哦~</p><p ng-if="date!=today&&recordDate">亲，<span>{{recordDate}}</span>那天您没有和 <span>{{chatTarget.name}}</span> 交流哦~</p><p ng-if="!recordDate">亲，您没有和 <span>{{chatTarget.name}}</span> 交流过哦~</p></div><div ng-show="loading" class="chat-loading chat-abs chat-center"><span class="fa fa-spinner fa-spin"></span> <span>正在载入中...</span></div></ul></div><div class="chat-record-foot chat-abs"><button ng-class="{\'chat-btn-opened\': showSearch}" ng-click="openSearch()" class="fa fa-search chat-record-search chat-btn"></button><p class="chat-record-search-option chat-abs" ng-show="showSearch">内容：<input type="text" ng-model="searchName" ng-keydown="enterSearchName($event)"> <button class="chat-btn" ng-click="searchRecord()">确定</button></p><span class="chat-record-date mg-l5 pd-l10"><div ng-click="showSelectDate($event)" class="fa fa-calendar chat-btn chat-rel"></div><datetime value="selectedDate" no-input="true" config="dateConfig" startdate="startDate" enddate="endDate"></datetime><span>{{date}}</span> </span><span class="chat-record-pa chat-abs"><button ng-class="{\'chat-disable\': currentPageNo <= 1}" ng-click="jumpToPage(1)" class="chat-btn fa fa-angle-double-left"></button> <button ng-class="{\'chat-disable\': currentPageNo <= 1}" ng-click="jumpToPage(+currentPageNo - 1)" class="chat-btn fa fa-angle-left"></button> <button ng-class="{\'chat-disable\': currentPageNo >= total}" ng-click="jumpToPage(+currentPageNo + 1)" class="chat-btn fa fa-angle-right"></button> <button ng-class="{\'chat-disable\': currentPageNo >= total}" ng-click="jumpToPage(total)" class="chat-btn fa fa-angle-double-right"></button></span></div></div></div><div ng-show="showNoTarget" class="chat-no-target chat-abs chat-center"><span class="image-chat-big chat-dis-inlineblock"></span><p>赶紧找个人聊天吧</p></div><div ng-show="showDetail" class="chat-group-detail chat-abs chat-center"><div class="chat-header chat-drag"><span class="chat-target-name" ng-show="detailUser.gType !==\'CHAT_GRP\'">{{detailUser.type === \'user\' ? \'个人\' : \'群组\'}}资料</span> <span class="chat-target-name" ng-show="detailUser.gType ===\'CHAT_GRP\'">讨论组资料</span></div><div class="chat-body chat-abs chat-scrollbar"><div ng-show="detailUser.type!==\'user\' && !loading"><div ng-show="detailUser.course" class="chat-group-course chat-group-item"><div class="chat-detail-head">当前课程</div><div class="chat-detail-content"><img class="chat-course-img chat-abs" ng-src="{{detailUser.course.imgs.split(\',\')[0] || \'img/icon-65.gif\'}}" alt=""><div class="chat-course-info chat-dis-inlineblock"><p class="chat-course-name"><a ng-href="course-detail.html?id={{detailUser.course.id}}" target="_blank">{{detailUser.course.name}}</a></p><p class="chat-course-user">创建者：<span>{{detailUser.course.userName}}</span></p></div></div></div><div ng-show="detailUser.course" class="chat-group-item chat-group-teacher"><div class="chat-detail-head">老师 <span class="chat-user-count">({{detailUser.teacherOnline || 0}}/{{detailUser.userList.teachers.users.length}})</span></div><ul class="chat-detail-content"><li ng-click="enterChat(teacher)" class="chat-course-member chat-dis-inlineblock" ng-repeat="teacher in detailUser.userList.teachers.users"><div class="chat-avatar"><img class="chat-avatar" ng-src="{{teacher.img}}" alt=""></div><span class="chat-member-role chat-teacher-guide" ng-show="teacher.role.indexOf(\'GUIDE\') !== -1">导</span> <span class="chat-member-role chat-teacher-answer" ng-show="teacher.role.indexOf(\'ANSWER\') !== -1">疑</span><p class="chat-member-name" title="{{teacher.name}}">{{teacher.name}}</p></li></ul></div><div ng-show="detailUser.course" class="chat-group-item chat-group-student"><div class="chat-detail-head"><span>学生</span> <span class="chat-user-count">({{detailUser.studentOnline || 0}}/{{detailUser.userList.students.users.length}})</span></div><ul class="chat-detail-content"><li ng-click="enterChat(student)" class="chat-course-member chat-dis-inlineblock" ng-repeat="student in detailUser.userList.students.users"><div class="chat-avatar"><img class="chat-avatar" ng-src="{{student.img}}" alt=""></div><p class="chat-member-name" title="{{student.name}}">{{student.name}}</p></li></ul></div><div ng-show="!detailUser.course" class="chat-group-item chat-group-student"><div class="chat-detail-head"><span>讨论组成员</span> <span class="chat-user-count">({{detailUser.studentOnline || 0}}/{{detailUser.userList.member.users.length}})</span></div><ul class="chat-detail-content"><li ng-click="enterChat(student)" class="chat-course-member chat-dis-inlineblock" ng-repeat="student in detailUser.userList.member.users"><div class="chat-avatar"><img class="chat-avatar" ng-src="{{student.img}}" alt=""></div><p class="chat-member-name" title="{{student.name}}">{{student.name}}</p></li></ul></div></div><div class="chat-user-detail chat-center chat-abs" ng-show="detailUser.type==\'user\' && !loading"><div class="chat-avatar"><img ng-src="{{detailUser.img}}" alt=""></div><p class="chat-detail-name">{{detailUser.name}}</p><p><span>{{detailUser.gender || \'男\'}}</span>，<span>{{detailUser.age || 15}}</span>岁</p><p>地区：<span>{{detailUser.addr || \'广东广州\'}}</span></p><p>教育经历：<span>{{detailUser.edu || \'广东工业大学 本科\'}}</span>，专业：<span>{{detailUser.master || \'电子商务\'}}</span></p></div><div ng-show="loading" class="chat-loading chat-abs chat-center"><span class="fa fa-spinner fa-spin"></span> <span>正在载入中...</span></div></div><div class="chat-foot chat-abs"><button class="chat-btn" ng-click="enterChat(detailUser.origin || detailUser)">发起聊天</button></div></div><div ng-show="showFriendRequest" class="chat-notify-window"><div class="chat-header chat-drag"><span class="chat-target-name">好友通知</span></div><div class="chat-body chat-abs chat-request-list" ng-show="!loadingFriendRequest"><ul class="chat-body-left chat-center chat-scrollbar" ng-hide="!friendRequests.length"><li ng-repeat="request in friendRequests | orderBy: \'-time\'" class="chat-request-item"><p class="chat-black-text mg-b5">{{request.date}}</p><div ng-if="request.r === self.uuid"><div class="chat-dis-inlineblock"><img ng-src="{{request.lImg || \'/img/icon-252.png\'}}" alt="" class="chat-user-avatar"></div><div class="chat-dis-inlineblock"><p class="chat-black-text">{{request.lName || \'name\'}}</p><p ng-if="request.msg">验证信息：<span>{{request.msg}}</span></p><p ng-if="!request.msg">对方请求加您为好友</p><span class="chat-request-btn"><button ng-show="request.status === 1" class="chat-btn" ng-click="handleRequest(request, 4)">同意</button> <button ng-show="request.status === 1" class="chat-btn" ng-click="handleRequest(request, 2)">拒绝</button> <span ng-show="request.status === 4"><button class="chat-btn" ng-click="sendMsg(request)">发消息</button></span> <span ng-show="request.status === 2">已拒绝</span></span></div></div><div ng-if="request.l === self.uuid"><div class="chat-dis-inlineblock"><img ng-src="{{request.rImg || \'/img/icon-252.png\'}}" alt="" class="chat-user-avatar"></div><div class="chat-dis-inlineblock"><p class="chat-black-text">{{request.rName || \'name\'}}</p><p ng-if="request.status === 4">对方已同意您的好友请求</p><p ng-if="request.status === 2">对方已拒绝您的好友请求</p><p ng-if="request.status === 1 || request.status === 3">等待对方的回复</p><span class="chat-request-btn"><span ng-show="request.status === 1">等待中</span> <span ng-show="request.status === 4"><button class="chat-btn" ng-click="sendMsg(request)">发消息</button></span> <span ng-show="request.status === 2">已拒绝</span></span></div></div></li></ul><div ng-show="!friendRequests.length" style="padding:50px 0;text-align:center;color:#ccc">暂未收到好友请求。</div></div><div ng-show="loadingFriendRequest" class="chat-loading chat-abs chat-center"><span class="fa fa-spinner fa-spin"></span> <span>正在载入中...</span></div></div><div class="chat-pos-fixed chat-pos-center chat-bg-transparent" ng-show="showScreenshot"><div class="chat-dis-table"><div class="chat-dis-tablecell"><div class="chat-screenshot-preview"><div class="chat-screenshot-preview-head">发送截图</div><div class="chat-screenshot-preview-body"><div><img src="{{base64}}" alt="" ng-style="screenshotImgStyle"></div><div><button class="chat-send-btn" ng-click="sendScreenshot()">发送截图</button> <button ng-click="cancelScreenshot()">取消</button></div><div>按Enter键快速发送截图，按ESC键取消发送。</div></div></div></div></div></div></div><div ng-show="show===\'addFriend\'" class="chat-add-friend chat-abs" ng-controller="addFriend"><div class="chat-search-detail chat-abs chat-center"><div ng-show="hasUserLogin" class="chat-search-full chat-scrollbar"><div class="chat-friend-search" ng-class="{\'chat-searching\': searchLoading}"><input type="text" class="chat-search-name" ng-model="searchName" ng-keydown="keydown($event)"> <button class="chat-btn" ng-hide="searchLoading" ng-click="search()"><span class="fa fa-search"></span></button> <button class="chat-btn" ng-show="searchLoading"><span class="fa fa-spinner fa-spin"></span></button></div><ul ng-hide="loading"><li ng-repeat="user in searchList" class="chat-friend-item chat-dis-inlineblock"><div class="chat-dis-inlineblock"><img class="chat-user-avatar" ng-src="{{user.img}}" alt=""></div><div class="chat-dis-inlineblock"><div class="chat-user-name" title="{{user.name}}">{{user.name}}</div><button class="chat-btn-addfriend" ng-click="addFriend(user)">+好友</button></div></li></ul><div ng-show="!searchList.length && !loading" class="chat-no-search"><div class="image-chat-add-icon"></div><p ng-show="!searched">赶紧添加几个好友吧</p><p ng-show="searched">搜索不到与 <span>{{searchName}}</span> 有关的用户</p></div><div ng-show="loading" class="chat-loading chat-abs chat-center"><span class="fa fa-spinner fa-spin"></span> <span>正在载入中...</span></div></div><div ng-show="!hasUserLogin" class="chat-login-tips chat-abs chat-center"><p style="font-size:16px">o(^▽^)o</p><p style="font-size:16px;margin-bottom:10px">需要先登录哦~</p><p><a href="" ng-click="showLoginWindow()">马上登录</a></p></div><div class="chat-search-pa" ng-hide="!searchList.length || !hasUserLogin"><button class="chat-btn" ng-disabled="currentPageNo<=1" ng-click="goToSearchPage(currentPageNo - 1)" ng-class="{\'chat-disable\': currentPageNo <= 1}">上一页</button> <button class="chat-btn" ng-class="{\'chat-active\': currentPageNo === p}" ng-repeat="p in pa" ng-click="goToSearchPage(p)">{{p}}</button> <button class="chat-btn" ng-disabled="currentPageNo>=totalPage" ng-click="goToSearchPage(currentPageNo + 1)" ng-class="{\'chat-disable\': currentPageNo >= totalPage}">下一页</button> <span>总共 <span>{{totalPage}} 页</span></span></div></div></div><div ng-show="show===\'addGroup\'" class="chat-add-group chat-abs" ng-controller="addGroup"><div class="chat-add-main chat-abs" ng-show="hasUserLogin"><div class="chat-left chat-abs"><div class="chat-user-search"><input type="text" ng-model="searchUser"> <button class="icon-magnifier chat-btn"></button></div><div class="chat-scrollbar chat-abs"><div class="chat-friends" ng-repeat="group in groups" ng-if="[\'DEFAULT\', \'T-GRP\', \'S-GRP\'].indexOf(group.type)!=-1"><div class="chat-group-name"><a href="" ng-click="group.collapse=!group.collapse"><span class="fa" ng-class="{\'fa-angle-down\': !group.collapse, \'fa-angle-right\':group.collapse}"></span> <span>{{group.name}}</span></a></div><div ng-hide="group.collapse"><ul class="chat-group-list"><li ng-repeat="user in group.users" ng-hide="hideUnrelativeItem(user.name)" ng-if="showUnselected(user)"><a href="" ng-click="selectUser(user)"><input type="checkbox" ng-model="user.selected"> <span class="chat-avatar"><img ng-src="{{user.img}}" alt=""> </span><span class="chat-user-name" title="{{user.name}}">{{user.name}}</span></a></li></ul></div></div></div></div><div class="chat-center chat-add-selected chat-abs"><button class="fa fa-angle-right chat-btn" ng-click="confirmSelect()"></button></div><div class="chat-right chat-abs"><div>已选联系人：<span>{{selected.length || 0}}</span> 人</div><ul class="chat-scrollbar chat-abs chat-group-list"><li ng-repeat="user in selected" ng-mouseenter="user.showDelete=true" ng-mouseleave="user.showDelete=false"><span class="chat-avatar"><img ng-src="{{user.img}}" alt=""> </span><span class="chat-user-name" title="{{user.name}}">{{user.name}}</span> <button class="chat-btn icon-close chat-abs chat-remove-select" ng-show="user.showDelete" ng-click="removeSelected(user)"></button></li></ul></div></div><div ng-show="hasUserLogin" class="chat-foot chat-abs"><button class="chat-btn" ng-click="addGroup()">确定</button> <button class="chat-btn" ng-click="close()">取消</button></div><div ng-show="!hasUserLogin" class="chat-login-tips chat-abs chat-center"><p style="font-size:16px">o(^▽^)o</p><p style="font-size:16px;margin-bottom:10px">需要先登录哦~</p><p><a href="" ng-click="showLoginWindow()">马上登录</a></p></div></div><div ng-show="show===\'serve\'" class="chat-serve chat-abs"><ul ng-show="hasUserLogin && myCourse.length" class="chat-serve-list chat-abs chat-scrollbar"><li ng-repeat="course in myCourse" class="chat-serve-course"><div class="chat-detail-content"><img class="chat-course-img chat-abs" ng-src="{{course.cImg.split(\',\')[0] || \'img/icon-65.gif\'}}" alt=""><div class="chat-course-info chat-dis-inlineblock"><p class="chat-course-name"><a target="_blank" ng-href="course-detail.html?id={{course.cid}}">{{course.cname}}</a></p><p>参与人数：<span>{{course.uCnt || 0}}</span> 人</p><div class="chat-serve-teacher"><span>答疑：</span> <a href="" ng-click="enterChat(teacher)" ng-repeat="teacher in course.teachers" title="{{teacher.name}}" class="chat-avatar"><img ng-class="{grayscale: !teacher.online}" ng-src="{{teacher.img}}" alt=""></a></div><button class="chat-btn" ng-click="findTeacher(course.teachers)"><span class="image-chat-msg-icon chat-dis-inlineblock"></span>找老师</button></div></div></li></ul><div ng-show="hasUserLogin && !myCourse.length" style="margin:40px 0;text-align:center"><img src="img/no-question.png" alt=""><p style="margin-top:20px">暂未参与任何课程。<a href="search-page.html?type=&query=" target="_blank" style="color:#02c0b9;vertical-align:bottom">立即参与课程</a></p></div><div ng-show="!hasUserLogin" class="chat-login-tips chat-abs chat-center"><p style="font-size:16px">o(^▽^)o</p><p style="font-size:16px;margin-bottom:10px">需要先登录哦~</p><p><a href="" ng-click="showLoginWindow()">马上登录</a></p></div></div><div class="chat-confirm-add" drag=".chat-confirm-drag" ng-show="showAddDialog"><div class="chat-header chat-confirm-drag"><span>添加好友</span> <button class="chat-close-window" ng-click="closeAddDialog()"><span class="icon-close"></span></button></div><div class="chat-body"><div class="chat-dis-inlineblock"><img class="chat-user-avatar" ng-src="{{addTarget.img}}" alt=""></div><div class="chat-dis-inlineblock"><p>您将添加以下好友：</p><p><span>{{addTarget.name}}</span></p></div><div class="mg-t10"><p>请输入验证信息：</p><textarea name="" id="" cols="30" rows="10" ng-model="msg" class="chat-confirm-msg"></textarea></div><div class="chat-foot"><button class="chat-btn" ng-click="requestAddFriend()">确定</button> <button class="chat-btn" ng-click="closeAddDialog()">关闭</button></div></div></div></div></div><div data-direction="left" class="chat-resize chat-resize-left"></div><div data-direction="right" class="chat-resize chat-resize-right"></div><div data-direction="top" class="chat-resize chat-resize-top"></div><div data-direction="bottom" class="chat-resize chat-resize-bottom"></div><div data-direction="top left" class="chat-resize-corner chat-resize chat-resize-corner-tl"></div><div data-direction="top right" class="chat-resize-corner chat-resize chat-resize-corner-tr"></div><div data-direction="bottom left" class="chat-resize-corner chat-resize chat-resize-corner-bl"></div><div data-direction="bottom right" class="chat-resize-corner chat-resize chat-resize-corner-br"></div></div></div></div>',
restrict:"E",scope:{position:"@",custom:"="},replace:!0};return e.link=function(e,a){function t(e,a){var t,c;h.css({top:h.position().top,bottom:"auto"}),h.css({left:h.position().left,right:"auto"}),p.width=h.width(),p.height=h.height(),m.width=angular.element(window).width(),m.height=angular.element(window).height(),t=a.clientX,c=a.clientY,u.left=t,u.top=c,n=e.split(" "),r=h.position(),l.on("mousemove",s),l.on("mouseup",i),d.addClass("no-select")}function s(e){var a,t,s,i;a=e.clientX,t=e.clientY,g.top=t-u.top,g.left=a-u.left,angular.forEach(n,function(e){switch(e){case"bottom":i=p.height+g.top,i=400>i?400:i,i=r.top+i>m.height?m.height-r.top:i,h.height(i);break;case"right":s=p.width+g.left,s=660>s?660:s,s=r.left+s>m.width?m.width-r.left:s,h.width(s);break;case"left":r.left+g.left<=0&&(g.left=-r.left),s=p.width-g.left,s=660>s?660:s,h.width(s).css({left:r.left+g.left});break;case"top":r.top+g.top<=0&&(g.top=-r.top),i=p.height-g.top,i=400>i?400:i,h.height(i).css({top:r.top+g.top})}})}function i(){l.off("mousemove",s),l.off("mouseup",i),d.removeClass("no-select"),c=null,o=null}var n,r,c,o,l=angular.element(document),d=angular.element("body"),g={top:0,left:0},u={left:0,top:0},h=a.find(".chat-window"),p={width:0,height:0},m={width:0,height:0};angular.element(".chat-resize").on("mousedown",function(e){var a=$(this).data("direction");t(a,e)})},e})}(),!module)var module=angular.module("RCP",[]);module.directive("emptyTip",function(){return{template:'<div class="empty-tip" ng-style="boxStyle"><style type="text/css">.empty-tip{text-align:center;padding:30px 0}.empty-tip .msg{padding:10px 0 0;color:#999}.empty-tip .img{width:100%}</style><div ng-show="theme==1"><img src="/rcp-common/imgs/common/no-data.png" class="img" ng-style="imgStyle"></div><div ng-show="!theme"><img src="/rcp-common/imgs/common/icon-cloud.png" ng-style="imgStyle"></div><div ng-show="!theme" class="msg"><span ng-hide="showLogin">{{msg}}</span> <a href="" style="color:#00f" ng-show="showLogin">请先登录</a></div></div>',restrict:"E",replace:!0,transclude:!0,scope:{c:"="},controller:["$scope","service",function(e,a){e.msg="暂无数据",e.c&&angular.forEach(e.c,function(a,t){e[t]=a}),"请先登录"===e.msg&&(e.showLogin=!0,e.dialog=function(e){a.dialog.alert(e)})}]}}),module.directive("spaceHead",function(){return{template:'<div class="space-head"><div class="head-info"><img ng-src="{{avatar}}" alt=""> <span class="title" ng-bind="headline"></span><div class="tips" ng-show="unReadNum > 0"><span class="separate"></span> <i class="image-unread-tips"></i><p class="text">温馨提示：当前您有<span ng-bind="unReadNum"></span>条未处理的消息！</p></div><div class="menu"><a href="/">酷校首页</a> <span class="separate"></span> <a class="logout" href="" ng-click="logout()">退出</a></div></div></div>',restrict:"E",replace:!0,transclude:!0,scope:{headline:"@",avatar:"=",unReadNum:"="},controller:["$scope",function(e){e.logout=function(){var e=location.protocol+"//"+location.host;location.href=rcpAid.getUrl("退出",{url:encodeURIComponent(e)})}}]}}),module.directive("userList",function(){return{template:'<div class="user-list"><div class="section-header"><i class="image-chat-icon"></i> <span>消息</span></div><div class="user-search white-bg"><i class="fa fa-search" aria-hidden="true"></i> <input ng-model="searchUser" type="text" placeholder="搜索学生"></div><ul class="user-list-detail l-scrollbar white-bg"><li title="{{user.nickName}}" class="user-item" ng-class="{active: user.uuid===chatTarget.uuid}" ng-repeat="user in users"><div class="info-avatar"><img ng-src="{{user.avatar}}" alt=""> <span ng-show="user.unread > 0" class="chat-unread" ng-class="{\'w-18\': user.unread <= 99, \'w-25\': user.unread > 99}" ng-bind="user.unread > 99 ? \'99+\' : user.unread"></span></div><div class="info-block"><p><span class="user-name" ng-bind="user.nickName"></span> <span class="time" ng-show="user.msgList.length">{{user.msgList[user.msgList.length - 1].time}}</span></p><p><span class="user-last-msg" ng-show="user.msgList.length">{{user.msgList[user.msgList.length - 1].message}}</span> <span class="type-text">{{user.type == 0 ? \'用户\' : \'游客\'}}</span></p></div></li></ul></div>',restrict:"E",replace:!0,transclude:!0,scope:{users:"="},controller:["$scope",function(e){e.searchUser=""}]}}),module.directive("spaceChat",function(){return{template:'<div class="chat-main"><div class="section-header"><div class="target"><i class="fa fa-chevron-left" aria-hidden="true"></i> <img ng-src="{{chatUser.avatar}}" alt=""> <span title="{{chatUser.nickName}}" ng-bind="chatUser.nickName"></span></div><span class="address" ng-show="chatUser.address">{{\'来自\' + chatUser.address}}</span></div><div class="chat-body" ng-hide="showMsgRecord"><div class="chat-body-left chat-center"><div class="chat-history"><ul><div data="{{loadingMsg}}" data-a="{{noMoreMsg}}" ng-hide="loadingMsg || noMoreMsg" class="chat-show-more"><a href="" ng-click="loadMoreMsg()"><span class="fa fa-clock-o"></span>查看更多消息</a></div><div ng-show="loadingMsg" class="chat-show-more"><span class="fa fa-spinner fa-spin"></span>正在载入</div><chat-msg chat-type="chatType" index="{{$index}}" ng-repeat="msg in currentChatMsg" msg="msg" id="msg-{{currentChatMsg.length - $index}}"></chat-msg></ul></div><a ng-show="unreadMsg>0" class="chat-unread-msg" ng-click="showNewMsg()">您有 <span ng-bind="unreadMsg"></span> 条新消息</a><div class="chat-editor"><div class="chat-editor-helper chat-rel"><i class="image-chat-upload-image"></i> <i class="image-chat-upload-file"></i><div class="chat-open-record"><i class="fa fa-clock-o"></i> <a href="" ng-class="{\'chat-btn-opened\': showMsgRecord}" ng-click="openMsgRecord()">消息记录</a></div><input type="file" id="chat-img-upload" accept="image/*"> <input type="file" id="chat-file-upload" accept="*"></div><div class="chat-editor-input"><textarea name="" id="msg-content" cols="30" rows="10" ng-model="msg" ng-keydown="typeMsg($event)"></textarea></div><div class="chat-send"><button class="chat-btn chat-btn-active" ng-click="send()">发送</button></div></div></div></div></div>',restrict:"E",replace:!0,transclude:!0,scope:{chatUser:"="},controller:["$scope",function(e){}]}}),module.directive("callScroll",["$parse",function(e){return{restrict:"A",compile:function(a,t){var s=e(t.callScroll,null,!0);return function(e,a){a.on("scroll",function(a){var t=function(){s(e,{$event:a})};e.$apply(t)})}}}}]),module.directive("userCourses",function(){return{template:'<div class="user-courses"><div class="course-list l-scrollbar" call-scroll="scrollTo(\'course\')"><ul ng-show="loaded.course && list.course.length"><li ng-repeat="course in list.course track by $index" ng-class="{\'m-t-16\': $index > 0}"><div class="left"><ng-img c="{\'img\': course.imgUrl, \'default\': \'/rcp-common/imgs/icon/gray-default-img.png\', \'divClass\': \'cover\', \'imgClass\': \'cover-img\'}"></ng-img><div class="progress"><div class="bg"></div><div class="white"><div class="green" ng-style="{\'width\': course.progress + \'%\'}"></div><span class="text">{{course.progress + \'%\'}}</span></div></div></div><div class="right"><p class="title" title="{{course.title}}" ng-bind="course.title"></p><p class="status"><span>课程状态：</span><span ng-class="{\'green\': course.status == 0, \'blue\': course.status != 0}">{{course.status == 0 ? \'已完成\' : \'进行中\'}}</span></p><p class="grades">{{\'分数：\' + (!isNaN(course.grades) ? course.grades + \'分\' : \'暂无\')}}</p></div><a class="detail" ng-href="{{course.detailUrl}}" target="_blank">查看详情</a></li></ul><loader-ui show="loaded.course"></loader-ui><empty-tip ng-show="loaded.course && !list.course.length"></empty-tip></div><div class="teacher-guide"><p class="guide-title"><i class="fa fa-bookmark" aria-hidden="true"></i><span>老师评价</span></p><div class="guide-list l-scrollbar" ng-show="loaded.guide && list.guide.length" call-scroll="scrollTo(\'guide\')"><ul><li ng-repeat="guide in list.guide"><img src="" alt="" ng-src="{{guide.avatar}}"><div class="right-desc"><p class="name">来自“<span ng-bind="guide.name"></span>”的评价</p><p class="desc" title="{{guide.desc}}" ng-bind="guide.desc"></p></div></li></ul></div><loader-ui show="loaded.guide"></loader-ui><empty-tip ng-show="loaded.guide && !list.guide.length"></empty-tip></div></div>',restrict:"E",replace:!0,transclude:!0,controller:["$scope","$timeout","service","course",function(e,a,t,s){e.loaded={course:!1,guide:!1},e.request={course:{host:"*",sort:-9,status:1,page:1,pageCount:5},guide:{}},e.list={course:[],guide:[]};var i=function(a){if(a&&a.length)for(var t,s=e.list.course,i=0,n=a.length;n>i;i++)t=a[i],s.push({detailUrl:rcpAid.getUrl(10==t.type?"课程详情":"题库详情",{cid:t.id}),imgUrl:t.imgs&&t.imgs[0]||"",progress:45,title:t.title,status:1,grades:90})},n=function(e){},r=function(a,s){e.request[a+"all"]||e.request[a+"ing"]||(e.request[a+"ing"]=!0,s(e.request[a]).then(function(r){return e.loaded[a]=!0,r?r.data.allCount&&r.data.courses&&r.data.courses.length?("course"==a&&i(r.data.courses)||"guide"==a&&n(r.data),e.request[a].page++,void(e.request[a+"ing"]=!1)):void(e.request[a+"all"]=!0):(console.error(("course"==a?"其它课程":"老师评价")+"请求返回为空",a,s,r),t.dialog.alert(("course"==a?"其它课程":"老师评价")+"请求失败"),void(e.request[a+"ing"]=!1))},function(s){e.loaded[a]=!0,e.request[a+"ing"]=!1,console.error(("course"==a?"其它课程":"老师评价")+"请求失败",a,s),s.data&&s.data.data&&301!=s.data.data.code&&t.dialog.alert(("course"==a?"其它课程":"老师评价")+"请求失败")}))};e.scrollTo=function(e){"course"==e&&$(".user-courses .course-list").height()+$(".user-courses .course-list").scrollTop()>$(".user-courses .course-list > ul").height()-10?r("course",s.getStudentCourse):"guide"==e&&$(".user-courses .guide-list").height()+$(".user-courses .guide-list").scrollTop()>$(".user-courses .guide-list > ul").height()-10},a(function(){r("course",s.getStudentCourse)})}]}});