(function(e){function t(e,t,n){switch(arguments.length){case 2:return null!=e?e:t;case 3:return null!=e?e:null!=t?t:n;default:throw new Error("Implement me")}}function n(e,t){return Me.call(e,t)}function a(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function r(e){_e.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function i(e,t){var n=!0;return h(function(){return n&&(r(e),n=!1),t.apply(this,arguments)},t)}function s(e,t){pt[e]||(r(t),pt[e]=!0)}function o(e,t){return function(n){return g(e.call(this,n),t)}}function c(e,t){return function(n){return this.localeData().ordinal(e.call(this,n),t)}}function l(){}function u(e,t){t!==!1&&Y(e),m(this,e),this._d=new Date(+e._d)}function d(e){var t=T(e),n=t.year||0,a=t.quarter||0,r=t.month||0,i=t.week||0,s=t.day||0,o=t.hour||0,c=t.minute||0,l=t.second||0,u=t.millisecond||0;this._milliseconds=+u+1e3*l+6e4*c+36e5*o,this._days=+s+7*i,this._months=+r+3*a+12*n,this._data={},this._locale=_e.localeData(),this._bubble()}function h(e,t){for(var a in t)n(t,a)&&(e[a]=t[a]);return n(t,"toString")&&(e.toString=t.toString),n(t,"valueOf")&&(e.valueOf=t.valueOf),e}function m(e,t){var n,a,r;if("undefined"!=typeof t._isAMomentObject&&(e._isAMomentObject=t._isAMomentObject),"undefined"!=typeof t._i&&(e._i=t._i),"undefined"!=typeof t._f&&(e._f=t._f),"undefined"!=typeof t._l&&(e._l=t._l),"undefined"!=typeof t._strict&&(e._strict=t._strict),"undefined"!=typeof t._tzm&&(e._tzm=t._tzm),"undefined"!=typeof t._isUTC&&(e._isUTC=t._isUTC),"undefined"!=typeof t._offset&&(e._offset=t._offset),"undefined"!=typeof t._pf&&(e._pf=t._pf),"undefined"!=typeof t._locale&&(e._locale=t._locale),$e.length>0)for(n in $e)a=$e[n],r=t[a],"undefined"!=typeof r&&(e[a]=r);return e}function f(e){return 0>e?Math.ceil(e):Math.floor(e)}function g(e,t,n){for(var a=""+Math.abs(e),r=e>=0;a.length<t;)a="0"+a;return(r?n?"+":"":"-")+a}function p(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function v(e,t){var n;return t=P(t,e),e.isBefore(t)?n=p(e,t):(n=p(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n}function y(e,t){return function(n,a){var r,i;return null===a||isNaN(+a)||(s(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),i=n,n=a,a=i),n="string"==typeof n?+n:n,r=_e.duration(n,a),_(this,r,e),this}}function _(e,t,n,a){var r=t._milliseconds,i=t._days,s=t._months;a=null==a?!0:a,r&&e._d.setTime(+e._d+r*n),i&&me(e,"Date",he(e,"Date")+i*n),s&&de(e,he(e,"Month")+s*n),a&&_e.updateOffset(e,i||s)}function k(e){return"[object Array]"===Object.prototype.toString.call(e)}function b(e){return"[object Date]"===Object.prototype.toString.call(e)||e instanceof Date}function w(e,t,n){var a,r=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),s=0;for(a=0;r>a;a++)(n&&e[a]!==t[a]||!n&&D(e[a])!==D(t[a]))&&s++;return s+i}function x(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=lt[e]||ut[t]||t}return e}function T(e){var t,a,r={};for(a in e)n(e,a)&&(t=x(a),t&&(r[t]=e[a]));return r}function M(t){var n,a;if(0===t.indexOf("week"))n=7,a="day";else{if(0!==t.indexOf("month"))return;n=12,a="month"}_e[t]=function(r,i){var s,o,c=_e._locale[t],l=[];if("number"==typeof r&&(i=r,r=e),o=function(e){var t=_e().utc().set(a,e);return c.call(_e._locale,t,r||"")},null!=i)return o(i);for(s=0;n>s;s++)l.push(o(s));return l}}function D(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=t>=0?Math.floor(t):Math.ceil(t)),n}function L(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function S(e,t,n){return oe(_e([e,11,31+t-n]),t,n).week}function C(e){return U(e)?366:365}function U(e){return e%4===0&&e%100!==0||e%400===0}function Y(e){var t;e._a&&-2===e._pf.overflow&&(t=e._a[Le]<0||e._a[Le]>11?Le:e._a[Se]<1||e._a[Se]>L(e._a[De],e._a[Le])?Se:e._a[Ce]<0||e._a[Ce]>24||24===e._a[Ce]&&(0!==e._a[Ue]||0!==e._a[Ye]||0!==e._a[Ie])?Ce:e._a[Ue]<0||e._a[Ue]>59?Ue:e._a[Ye]<0||e._a[Ye]>59?Ye:e._a[Ie]<0||e._a[Ie]>999?Ie:-1,e._pf._overflowDayOfYear&&(De>t||t>Se)&&(t=Se),e._pf.overflow=t)}function I(t){return null==t._isValid&&(t._isValid=!isNaN(t._d.getTime())&&t._pf.overflow<0&&!t._pf.empty&&!t._pf.invalidMonth&&!t._pf.nullInput&&!t._pf.invalidFormat&&!t._pf.userInvalidated,t._strict&&(t._isValid=t._isValid&&0===t._pf.charsLeftOver&&0===t._pf.unusedTokens.length&&t._pf.bigHour===e)),t._isValid}function A(e){return e?e.toLowerCase().replace("_","-"):e}function $(e){for(var t,n,a,r,i=0;i<e.length;){for(r=A(e[i]).split("-"),t=r.length,n=A(e[i+1]),n=n?n.split("-"):null;t>0;){if(a=O(r.slice(0,t).join("-")))return a;if(n&&n.length>=t&&w(r,n,!0)>=t-1)break;t--}i++}return null}function O(e){var t=null;if(!Ae[e]&&Oe)try{t=_e.locale(),require("./locale/"+e),_e.locale(t)}catch(n){}return Ae[e]}function P(e,t){var n,a;return t._isUTC?(n=t.clone(),a=(_e.isMoment(e)||b(e)?+e:+_e(e))-+n,n._d.setTime(+n._d+a),_e.updateOffset(n,!1),n):_e(e).local()}function E(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function G(e){var t,n,a=e.match(Ne);for(t=0,n=a.length;n>t;t++)gt[a[t]]?a[t]=gt[a[t]]:a[t]=E(a[t]);return function(r){var i="";for(t=0;n>t;t++)i+=a[t]instanceof Function?a[t].call(r,e):a[t];return i}}function N(e,t){return e.isValid()?(t=F(t,e.localeData()),dt[t]||(dt[t]=G(t)),dt[t](e)):e.localeData().invalidDate()}function F(e,t){function n(e){return t.longDateFormat(e)||e}var a=5;for(Fe.lastIndex=0;a>=0&&Fe.test(e);)e=e.replace(Fe,n),Fe.lastIndex=0,a-=1;return e}function W(e,t){var n,a=t._strict;switch(e){case"Q":return Je;case"DDDD":return Xe;case"YYYY":case"GGGG":case"gggg":return a?et:Re;case"Y":case"G":case"g":return nt;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return a?tt:He;case"S":if(a)return Je;case"SS":if(a)return Qe;case"SSS":if(a)return Xe;case"DDD":return ze;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Ke;case"a":case"A":return t._locale._meridiemParse;case"x":return qe;case"X":return Be;case"Z":case"ZZ":return Ve;case"T":return Ze;case"SSSS":return je;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return a?Qe:We;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return We;case"Do":return a?t._locale._ordinalParse:t._locale._ordinalParseLenient;default:return n=new RegExp(B(q(e.replace("\\","")),"i"))}}function z(e){e=e||"";var t=e.match(Ve)||[],n=t[t.length-1]||[],a=(n+"").match(ot)||["-",0,0],r=+(60*a[1])+D(a[2]);return"+"===a[0]?-r:r}function R(e,t,n){var a,r=n._a;switch(e){case"Q":null!=t&&(r[Le]=3*(D(t)-1));break;case"M":case"MM":null!=t&&(r[Le]=D(t)-1);break;case"MMM":case"MMMM":a=n._locale.monthsParse(t,e,n._strict),null!=a?r[Le]=a:n._pf.invalidMonth=t;break;case"D":case"DD":null!=t&&(r[Se]=D(t));break;case"Do":null!=t&&(r[Se]=D(parseInt(t.match(/\d{1,2}/)[0],10)));break;case"DDD":case"DDDD":null!=t&&(n._dayOfYear=D(t));break;case"YY":r[De]=_e.parseTwoDigitYear(t);break;case"YYYY":case"YYYYY":case"YYYYYY":r[De]=D(t);break;case"a":case"A":n._isPm=n._locale.isPM(t);break;case"h":case"hh":n._pf.bigHour=!0;case"H":case"HH":r[Ce]=D(t);break;case"m":case"mm":r[Ue]=D(t);break;case"s":case"ss":r[Ye]=D(t);break;case"S":case"SS":case"SSS":case"SSSS":r[Ie]=D(1e3*("0."+t));break;case"x":n._d=new Date(D(t));break;case"X":n._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=z(t);break;case"dd":case"ddd":case"dddd":a=n._locale.weekdaysParse(t),null!=a?(n._w=n._w||{},n._w.d=a):n._pf.invalidWeekday=t;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":e=e.substr(0,1);case"gggg":case"GGGG":case"GGGGG":e=e.substr(0,2),t&&(n._w=n._w||{},n._w[e]=D(t));break;case"gg":case"GG":n._w=n._w||{},n._w[e]=_e.parseTwoDigitYear(t)}}function H(e){var n,a,r,i,s,o,c;n=e._w,null!=n.GG||null!=n.W||null!=n.E?(s=1,o=4,a=t(n.GG,e._a[De],oe(_e(),1,4).year),r=t(n.W,1),i=t(n.E,1)):(s=e._locale._week.dow,o=e._locale._week.doy,a=t(n.gg,e._a[De],oe(_e(),s,o).year),r=t(n.w,1),null!=n.d?(i=n.d,s>i&&++r):i=null!=n.e?n.e+s:s),c=ce(a,r,i,o,s),e._a[De]=c.year,e._dayOfYear=c.dayOfYear}function j(e){var n,a,r,i,s=[];if(!e._d){for(r=V(e),e._w&&null==e._a[Se]&&null==e._a[Le]&&H(e),e._dayOfYear&&(i=t(e._a[De],r[De]),e._dayOfYear>C(i)&&(e._pf._overflowDayOfYear=!0),a=ae(i,0,e._dayOfYear),e._a[Le]=a.getUTCMonth(),e._a[Se]=a.getUTCDate()),n=0;3>n&&null==e._a[n];++n)e._a[n]=s[n]=r[n];for(;7>n;n++)e._a[n]=s[n]=null==e._a[n]?2===n?1:0:e._a[n];24===e._a[Ce]&&0===e._a[Ue]&&0===e._a[Ye]&&0===e._a[Ie]&&(e._nextDay=!0,e._a[Ce]=0),e._d=(e._useUTC?ae:ne).apply(null,s),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()+e._tzm),e._nextDay&&(e._a[Ce]=24)}}function K(e){var t;e._d||(t=T(e._i),e._a=[t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],j(e))}function V(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Z(t){if(t._f===_e.ISO_8601)return void Q(t);t._a=[],t._pf.empty=!0;var n,a,r,i,s,o=""+t._i,c=o.length,l=0;for(r=F(t._f,t._locale).match(Ne)||[],n=0;n<r.length;n++)i=r[n],a=(o.match(W(i,t))||[])[0],a&&(s=o.substr(0,o.indexOf(a)),s.length>0&&t._pf.unusedInput.push(s),o=o.slice(o.indexOf(a)+a.length),l+=a.length),gt[i]?(a?t._pf.empty=!1:t._pf.unusedTokens.push(i),R(i,a,t)):t._strict&&!a&&t._pf.unusedTokens.push(i);t._pf.charsLeftOver=c-l,o.length>0&&t._pf.unusedInput.push(o),t._pf.bigHour===!0&&t._a[Ce]<=12&&(t._pf.bigHour=e),t._isPm&&t._a[Ce]<12&&(t._a[Ce]+=12),t._isPm===!1&&12===t._a[Ce]&&(t._a[Ce]=0),j(t),Y(t)}function q(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,a,r){return t||n||a||r})}function B(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function J(e){var t,n,r,i,s;if(0===e._f.length)return e._pf.invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<e._f.length;i++)s=0,t=m({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._pf=a(),t._f=e._f[i],Z(t),I(t)&&(s+=t._pf.charsLeftOver,s+=10*t._pf.unusedTokens.length,t._pf.score=s,(null==r||r>s)&&(r=s,n=t));h(e,n||t)}function Q(e){var t,n,a=e._i,r=at.exec(a);if(r){for(e._pf.iso=!0,t=0,n=it.length;n>t;t++)if(it[t][1].exec(a)){e._f=it[t][0]+(r[6]||" ");break}for(t=0,n=st.length;n>t;t++)if(st[t][1].exec(a)){e._f+=st[t][0];break}a.match(Ve)&&(e._f+="Z"),Z(e)}else e._isValid=!1}function X(e){Q(e),e._isValid===!1&&(delete e._isValid,_e.createFromInputFallback(e))}function ee(e,t){var n,a=[];for(n=0;n<e.length;++n)a.push(t(e[n],n));return a}function te(t){var n,a=t._i;a===e?t._d=new Date:b(a)?t._d=new Date(+a):null!==(n=Pe.exec(a))?t._d=new Date(+n[1]):"string"==typeof a?X(t):k(a)?(t._a=ee(a.slice(0),function(e){return parseInt(e,10)}),j(t)):"object"==typeof a?K(t):"number"==typeof a?t._d=new Date(a):_e.createFromInputFallback(t)}function ne(e,t,n,a,r,i,s){var o=new Date(e,t,n,a,r,i,s);return 1970>e&&o.setFullYear(e),o}function ae(e){var t=new Date(Date.UTC.apply(null,arguments));return 1970>e&&t.setUTCFullYear(e),t}function re(e,t){if("string"==typeof e)if(isNaN(e)){if(e=t.weekdaysParse(e),"number"!=typeof e)return null}else e=parseInt(e,10);return e}function ie(e,t,n,a,r){return r.relativeTime(t||1,!!n,e,a)}function se(e,t,n){var a=_e.duration(e).abs(),r=Te(a.as("s")),i=Te(a.as("m")),s=Te(a.as("h")),o=Te(a.as("d")),c=Te(a.as("M")),l=Te(a.as("y")),u=r<ht.s&&["s",r]||1===i&&["m"]||i<ht.m&&["mm",i]||1===s&&["h"]||s<ht.h&&["hh",s]||1===o&&["d"]||o<ht.d&&["dd",o]||1===c&&["M"]||c<ht.M&&["MM",c]||1===l&&["y"]||["yy",l];return u[2]=t,u[3]=+e>0,u[4]=n,ie.apply({},u)}function oe(e,t,n){var a,r=n-t,i=n-e.day();return i>r&&(i-=7),r-7>i&&(i+=7),a=_e(e).add(i,"d"),{week:Math.ceil(a.dayOfYear()/7),year:a.year()}}function ce(e,t,n,a,r){var i,s,o=ae(e,0,1).getUTCDay();return o=0===o?7:o,n=null!=n?n:r,i=r-o+(o>a?7:0)-(r>o?7:0),s=7*(t-1)+(n-r)+i+1,{year:s>0?e:e-1,dayOfYear:s>0?s:C(e-1)+s}}function le(t){var n,a=t._i,r=t._f;return t._locale=t._locale||_e.localeData(t._l),null===a||r===e&&""===a?_e.invalid({nullInput:!0}):("string"==typeof a&&(t._i=a=t._locale.preparse(a)),_e.isMoment(a)?new u(a,!0):(r?k(r)?J(t):Z(t):te(t),n=new u(t),n._nextDay&&(n.add(1,"d"),n._nextDay=e),n))}function ue(e,t){var n,a;if(1===t.length&&k(t[0])&&(t=t[0]),!t.length)return _e();for(n=t[0],a=1;a<t.length;++a)t[a][e](n)&&(n=t[a]);return n}function de(e,t){var n;return"string"==typeof t&&(t=e.localeData().monthsParse(t),"number"!=typeof t)?e:(n=Math.min(e.date(),L(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e)}function he(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function me(e,t,n){return"Month"===t?de(e,n):e._d["set"+(e._isUTC?"UTC":"")+t](n)}function fe(e,t){return function(n){return null!=n?(me(this,e,n),_e.updateOffset(this,t),this):he(this,e)}}function ge(e){return 400*e/146097}function pe(e){return 146097*e/400}function ve(e){_e.duration.fn[e]=function(){return this._data[e]}}function ye(e){"undefined"==typeof ender&&(ke=xe.moment,e?xe.moment=i("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",_e):xe.moment=_e)}for(var _e,ke,be,we="2.8.4",xe="undefined"!=typeof global?global:this,Te=Math.round,Me=Object.prototype.hasOwnProperty,De=0,Le=1,Se=2,Ce=3,Ue=4,Ye=5,Ie=6,Ae={},$e=[],Oe="undefined"!=typeof module&&module&&module.exports,Pe=/^\/?Date\((\-?\d+)/i,Ee=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Ge=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,Ne=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,Fe=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,We=/\d\d?/,ze=/\d{1,3}/,Re=/\d{1,4}/,He=/[+\-]?\d{1,6}/,je=/\d+/,Ke=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Ve=/Z|[\+\-]\d\d:?\d\d/gi,Ze=/T/i,qe=/[\+\-]?\d+/,Be=/[\+\-]?\d+(\.\d{1,3})?/,Je=/\d/,Qe=/\d\d/,Xe=/\d{3}/,et=/\d{4}/,tt=/[+-]?\d{6}/,nt=/[+-]?\d+/,at=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,rt="YYYY-MM-DDTHH:mm:ssZ",it=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],st=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],ot=/([\+\-]|\d\d)/gi,ct=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),lt={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},ut={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},dt={},ht={s:45,m:45,h:22,d:26,M:11},mt="DDD w W M D d".split(" "),ft="M D H h m s w W".split(" "),gt={M:function(){return this.month()+1},MMM:function(e){return this.localeData().monthsShort(this,e)},MMMM:function(e){return this.localeData().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.localeData().weekdaysMin(this,e)},ddd:function(e){return this.localeData().weekdaysShort(this,e)},dddd:function(e){return this.localeData().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return g(this.year()%100,2)},YYYY:function(){return g(this.year(),4)},YYYYY:function(){return g(this.year(),5)},YYYYYY:function(){var e=this.year(),t=e>=0?"+":"-";return t+g(Math.abs(e),6)},gg:function(){return g(this.weekYear()%100,2)},gggg:function(){return g(this.weekYear(),4)},ggggg:function(){return g(this.weekYear(),5)},GG:function(){return g(this.isoWeekYear()%100,2)},GGGG:function(){return g(this.isoWeekYear(),4)},GGGGG:function(){return g(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return D(this.milliseconds()/100)},SS:function(){return g(D(this.milliseconds()/10),2)},SSS:function(){return g(this.milliseconds(),3)},SSSS:function(){return g(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+g(D(e/60),2)+":"+g(D(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+g(D(e/60),2)+g(D(e)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},x:function(){return this.valueOf()},X:function(){return this.unix()},Q:function(){return this.quarter()}},pt={},vt=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];mt.length;)be=mt.pop(),gt[be+"o"]=c(gt[be],be);for(;ft.length;)be=ft.pop(),gt[be+be]=o(gt[be],2);gt.DDDD=o(gt.DDD,3),h(l.prototype,{set:function(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e,t,n){var a,r,i;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),a=0;12>a;a++){if(r=_e.utc([2e3,a]),n&&!this._longMonthsParse[a]&&(this._longMonthsParse[a]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[a]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),n||this._monthsParse[a]||(i="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[a]=new RegExp(i.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[a].test(e))return a;if(n&&"MMM"===t&&this._shortMonthsParse[a].test(e))return a;if(!n&&this._monthsParse[a].test(e))return a}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,n,a;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;7>t;t++)if(this._weekdaysParse[t]||(n=_e([2e3,1]).day(t),a="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(a.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},_longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t,n){var a=this._calendar[e];return"function"==typeof a?a.apply(t,[n]):a},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,a){var r=this._relativeTime[n];return"function"==typeof r?r(e,t,n,a):r.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",_ordinalParse:/\d{1,2}/,preparse:function(e){return e},postformat:function(e){return e},week:function(e){return oe(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),_e=function(t,n,r,i){var s;return"boolean"==typeof r&&(i=r,r=e),s={},s._isAMomentObject=!0,s._i=t,s._f=n,s._l=r,s._strict=i,s._isUTC=!1,s._pf=a(),le(s)},_e.suppressDeprecationWarnings=!1,_e.createFromInputFallback=i("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),_e.min=function(){var e=[].slice.call(arguments,0);return ue("isBefore",e)},_e.max=function(){var e=[].slice.call(arguments,0);return ue("isAfter",e)},_e.utc=function(t,n,r,i){var s;return"boolean"==typeof r&&(i=r,r=e),s={},s._isAMomentObject=!0,s._useUTC=!0,s._isUTC=!0,s._l=r,s._i=t,s._f=n,s._strict=i,s._pf=a(),le(s).utc()},_e.unix=function(e){return _e(1e3*e)},_e.duration=function(e,t){var a,r,i,s,o=e,c=null;return _e.isDuration(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(o={},t?o[t]=e:o.milliseconds=e):(c=Ee.exec(e))?(a="-"===c[1]?-1:1,o={y:0,d:D(c[Se])*a,h:D(c[Ce])*a,m:D(c[Ue])*a,s:D(c[Ye])*a,ms:D(c[Ie])*a}):(c=Ge.exec(e))?(a="-"===c[1]?-1:1,i=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*a},o={y:i(c[2]),M:i(c[3]),d:i(c[4]),h:i(c[5]),m:i(c[6]),s:i(c[7]),w:i(c[8])}):"object"==typeof o&&("from"in o||"to"in o)&&(s=v(_e(o.from),_e(o.to)),o={},o.ms=s.milliseconds,o.M=s.months),r=new d(o),_e.isDuration(e)&&n(e,"_locale")&&(r._locale=e._locale),r},_e.version=we,_e.defaultFormat=rt,_e.ISO_8601=function(){},_e.momentProperties=$e,_e.updateOffset=function(){},_e.relativeTimeThreshold=function(t,n){return ht[t]===e?!1:n===e?ht[t]:(ht[t]=n,!0)},_e.lang=i("moment.lang is deprecated. Use moment.locale instead.",function(e,t){return _e.locale(e,t)}),_e.locale=function(e,t){var n;return e&&(n="undefined"!=typeof t?_e.defineLocale(e,t):_e.localeData(e),n&&(_e.duration._locale=_e._locale=n)),_e._locale._abbr},_e.defineLocale=function(e,t){return null!==t?(t.abbr=e,Ae[e]||(Ae[e]=new l),Ae[e].set(t),_e.locale(e),Ae[e]):(delete Ae[e],null)},_e.langData=i("moment.langData is deprecated. Use moment.localeData instead.",function(e){return _e.localeData(e)}),_e.localeData=function(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return _e._locale;if(!k(e)){if(t=O(e))return t;e=[e]}return $(e)},_e.isMoment=function(e){return e instanceof u||null!=e&&n(e,"_isAMomentObject")},_e.isDuration=function(e){return e instanceof d};for(be=vt.length-1;be>=0;--be)M(vt[be]);_e.normalizeUnits=function(e){return x(e)},_e.invalid=function(e){var t=_e.utc(NaN);return null!=e?h(t._pf,e):t._pf.userInvalidated=!0,t},_e.parseZone=function(){return _e.apply(null,arguments).parseZone()},_e.parseTwoDigitYear=function(e){return D(e)+(D(e)>68?1900:2e3)},h(_e.fn=u.prototype,{clone:function(){return _e(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var e=_e(this).utc();return 0<e.year()&&e.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():N(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):N(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return I(this)},isDSTShifted:function(){return this._a?this.isValid()&&w(this._a,(this._isUTC?_e.utc(this._a):_e(this._a)).toArray())>0:!1},parsingFlags:function(){return h({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(e){return this.zone(0,e)},local:function(e){return this._isUTC&&(this.zone(0,e),this._isUTC=!1,e&&this.add(this._dateTzOffset(),"m")),this},format:function(e){var t=N(this,e||_e.defaultFormat);return this.localeData().postformat(t)},add:y(1,"add"),subtract:y(-1,"subtract"),diff:function(e,t,n){var a,r,i,s=P(e,this),o=6e4*(this.zone()-s.zone());return t=x(t),"year"===t||"month"===t?(a=432e5*(this.daysInMonth()+s.daysInMonth()),r=12*(this.year()-s.year())+(this.month()-s.month()),i=this-_e(this).startOf("month")-(s-_e(s).startOf("month")),i-=6e4*(this.zone()-_e(this).startOf("month").zone()-(s.zone()-_e(s).startOf("month").zone())),r+=i/a,"year"===t&&(r/=12)):(a=this-s,r="second"===t?a/1e3:"minute"===t?a/6e4:"hour"===t?a/36e5:"day"===t?(a-o)/864e5:"week"===t?(a-o)/6048e5:a),n?r:f(r)},from:function(e,t){return _e.duration({to:this,from:e}).locale(this.locale()).humanize(!t)},fromNow:function(e){return this.from(_e(),e)},calendar:function(e){var t=e||_e(),n=P(t,this).startOf("day"),a=this.diff(n,"days",!0),r=-6>a?"sameElse":-1>a?"lastWeek":0>a?"lastDay":1>a?"sameDay":2>a?"nextDay":7>a?"nextWeek":"sameElse";return this.format(this.localeData().calendar(r,this,_e(t)))},isLeapYear:function(){return U(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=re(e,this.localeData()),this.add(e-t,"d")):t},month:fe("Month",!0),startOf:function(e){switch(e=x(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e?this.weekday(0):"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(t){return t=x(t),t===e||"millisecond"===t?this:this.startOf(t).add(1,"isoWeek"===t?"week":t).subtract(1,"ms")},isAfter:function(e,t){var n;return t=x("undefined"!=typeof t?t:"millisecond"),"millisecond"===t?(e=_e.isMoment(e)?e:_e(e),+this>+e):(n=_e.isMoment(e)?+e:+_e(e),n<+this.clone().startOf(t))},isBefore:function(e,t){var n;return t=x("undefined"!=typeof t?t:"millisecond"),"millisecond"===t?(e=_e.isMoment(e)?e:_e(e),+e>+this):(n=_e.isMoment(e)?+e:+_e(e),+this.clone().endOf(t)<n)},isSame:function(e,t){var n;return t=x(t||"millisecond"),"millisecond"===t?(e=_e.isMoment(e)?e:_e(e),+this===+e):(n=+_e(e),+this.clone().startOf(t)<=n&&n<=+this.clone().endOf(t))},min:i("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(e){return e=_e.apply(null,arguments),this>e?this:e}),max:i("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(e){return e=_e.apply(null,arguments),e>this?this:e}),zone:function(e,t){var n,a=this._offset||0;return null==e?this._isUTC?a:this._dateTzOffset():("string"==typeof e&&(e=z(e)),Math.abs(e)<16&&(e=60*e),!this._isUTC&&t&&(n=this._dateTzOffset()),this._offset=e,this._isUTC=!0,null!=n&&this.subtract(n,"m"),a!==e&&(!t||this._changeInProgress?_(this,_e.duration(a-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,_e.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(e){return e=e?_e(e).zone():0,(this.zone()-e)%60===0},daysInMonth:function(){return L(this.year(),this.month())},dayOfYear:function(e){var t=Te((_e(this).startOf("day")-_e(this).startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},quarter:function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},weekYear:function(e){var t=oe(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==e?t:this.add(e-t,"y")},isoWeekYear:function(e){var t=oe(this,1,4).year;return null==e?t:this.add(e-t,"y")},week:function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},isoWeek:function(e){var t=oe(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},weekday:function(e){var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},isoWeeksInYear:function(){return S(this.year(),1,4)},weeksInYear:function(){var e=this.localeData()._week;return S(this.year(),e.dow,e.doy)},get:function(e){return e=x(e),this[e]()},set:function(e,t){return e=x(e),"function"==typeof this[e]&&this[e](t),this},locale:function(t){var n;return t===e?this._locale._abbr:(n=_e.localeData(t),null!=n&&(this._locale=n),this)},lang:i("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===e?this.localeData():this.locale(t)}),localeData:function(){return this._locale},_dateTzOffset:function(){return 15*Math.round(this._d.getTimezoneOffset()/15)}}),_e.fn.millisecond=_e.fn.milliseconds=fe("Milliseconds",!1),_e.fn.second=_e.fn.seconds=fe("Seconds",!1),_e.fn.minute=_e.fn.minutes=fe("Minutes",!1),_e.fn.hour=_e.fn.hours=fe("Hours",!0),_e.fn.date=fe("Date",!0),_e.fn.dates=i("dates accessor is deprecated. Use date instead.",fe("Date",!0)),_e.fn.year=fe("FullYear",!0),_e.fn.years=i("years accessor is deprecated. Use year instead.",fe("FullYear",!0)),_e.fn.days=_e.fn.day,_e.fn.months=_e.fn.month,_e.fn.weeks=_e.fn.week,_e.fn.isoWeeks=_e.fn.isoWeek,_e.fn.quarters=_e.fn.quarter,_e.fn.toJSON=_e.fn.toISOString,h(_e.duration.fn=d.prototype,{_bubble:function(){var e,t,n,a=this._milliseconds,r=this._days,i=this._months,s=this._data,o=0;s.milliseconds=a%1e3,e=f(a/1e3),s.seconds=e%60,t=f(e/60),s.minutes=t%60,n=f(t/60),s.hours=n%24,r+=f(n/24),o=f(ge(r)),r-=f(pe(o)),i+=f(r/30),r%=30,o+=f(i/12),i%=12,s.days=r,s.months=i,s.years=o},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return f(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*D(this._months/12)},humanize:function(e){var t=se(this,!e,this.localeData());return e&&(t=this.localeData().pastFuture(+this,t)),this.localeData().postformat(t)},add:function(e,t){var n=_e.duration(e,t);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(e,t){var n=_e.duration(e,t);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(e){return e=x(e),this[e.toLowerCase()+"s"]()},as:function(e){var t,n;if(e=x(e),"month"===e||"year"===e)return t=this._days+this._milliseconds/864e5,n=this._months+12*ge(t),"month"===e?n:n/12;switch(t=this._days+Math.round(pe(this._months/12)),e){case"week":return t/7+this._milliseconds/6048e5;case"day":return t+this._milliseconds/864e5;case"hour":return 24*t+this._milliseconds/36e5;case"minute":return 24*t*60+this._milliseconds/6e4;
case"second":return 24*t*60*60+this._milliseconds/1e3;case"millisecond":return Math.floor(24*t*60*60*1e3)+this._milliseconds;default:throw new Error("Unknown unit "+e)}},lang:_e.fn.lang,locale:_e.fn.locale,toIsoString:i("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),n=Math.abs(this.days()),a=Math.abs(this.hours()),r=Math.abs(this.minutes()),i=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(n?n+"D":"")+(a||r||i?"T":"")+(a?a+"H":"")+(r?r+"M":"")+(i?i+"S":""):"P0D"},localeData:function(){return this._locale}}),_e.duration.fn.toString=_e.duration.fn.toISOString;for(be in ct)n(ct,be)&&ve(be.toLowerCase());_e.duration.fn.asMilliseconds=function(){return this.as("ms")},_e.duration.fn.asSeconds=function(){return this.as("s")},_e.duration.fn.asMinutes=function(){return this.as("m")},_e.duration.fn.asHours=function(){return this.as("h")},_e.duration.fn.asDays=function(){return this.as("d")},_e.duration.fn.asWeeks=function(){return this.as("weeks")},_e.duration.fn.asMonths=function(){return this.as("M")},_e.duration.fn.asYears=function(){return this.as("y")},_e.locale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,n=1===D(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),Oe?module.exports=_e:"function"==typeof define&&define.amd?(define("moment",function(e,t,n){return n.config&&n.config()&&n.config().noGlobal===!0&&(xe.moment=ke),_e}),ye(!0)):ye()}).call(this);var module=angular.module("RCP",["LocalStorageModule","ngCookies","ngSanitize","ngRoute"]);if(module.config(["$routeProvider",function(e){e.when("/coursesManager",{controller:"courseManagerCtrl",templateUrl:"../course/module/course-manager/course-manager.html"}).when("/rightManager",{templateUrl:"../space/teacher-space/deving.html"}).when("/studentManager",{templateUrl:"../space/teacher-space/deving.html"}).when("/scoreManager",{templateUrl:"../space/teacher-space/deving.html"}).when("/paperManager",{controller:"paperManagerCtrl",templateUrl:"../course/module/exam-score/exam-score.html"}).when("/acountInfo",{templateUrl:"../space/teacher-space/deving.html"}).when("/paper-detail/:pid/:cid/:tid",{controller:"pdCtrl",templateUrl:"../course/module/paper-detail/paper-detail.html"}).otherwise({redirectTo:"/coursesManager"})}]),module.controller("teacherSpaceCtrl",["$scope","service","$timeout",function(e,t,n){function a(){$(".loading").removeClass("loading"),$(".loading-img").removeClass("loading-img"),$(".loading-text").removeClass("loading-text")}e.user={avatar:"../rcp-common/imgs/face/d-face-1.png",nickName:"user",certification:!1,desc:"天生我才必有用~千金散尽还复来"},e.certificateUrl=rcpAid.getUrl("实名认证"),e.orderUrl=rcpAid.getUrl(),e.$on("login",function(n,r){if(!r)return void t.common.toLogin();var i=e.user;i.avatar=r.avatar||i.avatar,i.nickName=r.nickName||i.nickName,i.certification=!!r.certification,i.desc=r.desc||i.desc,a()})}]),module.config(["$provide",function(e){e.decorator("$exceptionHandler",["$delegate",function(e){return function(t,n){e(t,n),console.error({origin:"AngularJS Error",msg:t.message,stack:t.stack}),document.runErrorCallUpgrade()}}])}]),module.controller("mainCtrl",["$scope","$rootScope","$http","service","$cookies","$timeout",function(e,t,n,a,r,i){function s(){var e=localStorage.getItem("anonymousLoginUsr");return e&&"error"!==e?(t.anonymousUser=JSON.parse(e),void(r.stoken=t.anonymousUser.token)):void n({method:"GET",url:"http://"+g_conf.SSO+"/sso/api/anonymousLogin"}).then(function(e){if(0!==e.data.code)return console.error(e.data.msg,"匿名登录失败"),void localStorage.setItem("anonymousLoginUsr","error");var n=e.data.data;n.usr.token=n.token,localStorage.setItem("anonymousLoginToken",n.token),delete n.usr.BAttr,delete n.usr.attrs,localStorage.setItem("anonymousLoginUsr",JSON.stringify(n.usr)),t.anonymousUser=n.usr,r.stoken=n.usr.token},function(e){localStorage.setItem("anonymousLoginUsr","error"),console.error(e,"匿名登录失败")})}function o(n){R.token=rcpAid.getToken(),e.setUserData(UINFO),l(t.currentUser.role),console.log("checkLogin by token")}function c(e){console.log("未登陆",e),rcpAid.isLogin=0,l({}),i(function(){t.$broadcast("login","")},0)}function l(t){function n(t){angular.forEach(t,function(t){var n=!1;angular.forEach(e.itemList,function(e){t.name===e.name&&(n=!0)}),n||e.itemList.push(t)})}function a(){var e=rcpAid.getUrl,t=[];return angular.forEach(arguments,function(n){switch(n){case"学习中心":t.push({ic:"L2",name:n,href:e(n)});break;case"教学中心":t.push({ic:"L2",name:n,href:e(n)});break;case"助学中心":"undefined"==typeof isIE||isIE(9,9)||t.push({ic:"L2",name:n,href:e(n)});break;case"管理中心":t.push({ic:"L1",name:n,href:e(n)});break;case"创建新课程":t.push({ic:"L4",name:n,href:e("创建课程",{type:10})})}}),t}e.itemList=[],angular.forEach(t,function(t,r){switch(r){case"default":break;case"student":e.user.schoolId&&n(a("学校空间")),e.user.classId&&n(a("班级空间"));break;case"parent":n(a("家长空间"));break;case"teacher":e.user.schoolId&&n(a("学校空间")),e.user.classId&&n(a("班级空间"));break;case"help":n(a("助学中心"));break;case"class":n(a("班级空间","学校空间"));break;case"school":n(a("学校空间"));break;case"UCS_ADMIN":n(a("管理中心"));break;case"COURSE_VERIFY_ADMIN":n(a("管理中心"));break;case"PAGE_EDIT_ADMIN":n(a("管理中心"))}}),n(a("学习中心","教学中心","创建新课程","创建新题库"))}function u(){return t.currentUser={},$("body").show(),a.common.checkLogin(o,c),rcpAid.isLogin?void 0:(console.log("未登陆"),void s())}$("body").show();try{R=new ars.ARS,R.args={},R.delay=1e3,R.pushDelay=1e4,R.url=DYCONFIG.ars.rUrl+"pub/api/record",R.token=rcpAid.getToken(),R.start()}catch(d){R={}}e.setUserData=function(e){try{if(console.log(e),!e.uid)return;t.currentUser={uid:e.usr.id,nickName:e.usr.attrs.basic.nickName,avatar:e.usr.attrs.basic.avatar,desc:e.usr.attrs.basic.desc,role:e.usr.attrs.role||""},e.usr.attrs.pass&&(t.currentUser.certification=e.usr.attrs.pass.certification),console.log("发广播",t.currentUser),i(function(){t.$broadcast("login",t.currentUser)},0)}catch(n){console.log(n)}},u()}]),module.directive("pagination",function(){return{template:'<div class="page-bar" ng-show="list.length>0"><a href="javascript:;" ng-class="current<=0?\'disabled\':\'\'" ng-click="prev()"><em class="emic">&lt;</em><em class="emf">上一页</em></a><a href="javascript:;" ng-repeat="key in keyList" ng-class="key==current ? \'cur\' : \'\'" ng-click="jump(key)">{{key+1}}</a><span ng-show="pLen>pMax && !hideEllipsis">...</span><a href="javascript:;" ng-class="current>=pLen-1?\'disabled\':\'\'" ng-click="next()"><em class="emf">下一页</em><em class="emic">&gt;</em></a><span class="jump-bar"><span>共<font class="blue-c">{{pLen}}</font>页</span><span>跳到 <input type="text" style="width:38px;height:19px;text-align:center;" ng-model="goKey"> 页</span><a href="" ng-click="go(goKey)">GO</a></span></div>',restrict:"E",replace:!0,transclude:!0,scope:{list:"=list",pagefn:"=pagefn",pageargs:"=pageargs",deepwatch:"="},controller:["$scope","$element","$attrs","service",function(e,t,n,a){e.$watch("pageargs",function(t,n){t&&(e.current=parseInt(e.pageargs.pn)-1,e.pageNode=e.current,e.pNum=parseInt(e.pageargs.ps),e.pMax=parseInt(e.pageargs.pl)||5,e.pagefn(e.pageargs,function(t){e.pLen=Math.ceil(parseInt(t.pa.total)/e.pNum),e.keyListWatch()}))},e.deepwatch),e.reKeyList=function(t,n,a){e.keyList=[];for(var r=t;n>r&&!(r>=a);r++)e.hideEllipsis=r+1==e.pLen,e.keyList.push(r)},e.keyListWatch=function(){var t=e.pLen;if(t>e.pMax){var n=Math.ceil(e.pMax/2),a=e.current;a>=n&&a<t-(e.pMax-n)?e.reKeyList(a-(e.pMax-n),a+n,t):a>=t-(e.pMax-n)?e.reKeyList(t-e.pMax,t,t):n>=a&&e.reKeyList(0,t,e.pMax)}else e.reKeyList(0,t,e.pMax)},e.jump=function(t){e.pageNode!=t&&(e.current=t,e.pageNode=t,e.pageargs.pn=t+1,e.pagefn(e.pageargs,function(t){e.pLen=Math.ceil(parseInt(t.pa.total)/e.pNum),e.keyListWatch()}))},e.next=function(){e.current++,e.current>=e.pLen&&(e.current=e.pLen-1),e.jump(e.current)},e.prev=function(){e.current--,e.current<=0&&(e.current=0),e.jump(e.current)},e.go=function(t){var n=/^-?\d+$/g;void 0==t||t.length<=0?a.dialog.alert("输入不能为空！",{}):n.test(t)?(parseInt(t)>e.pLen?(t=e.pLen,a.dialog.alert("总共只有"+e.pLen+"页，为您转到最后一页！",{})):parseInt(t)<=0&&(t=1,a.dialog.alert("不能低于第1页,为您转到最前一页！",{})),e.jump(parseInt(t)-1),e.goKey=void 0):t.match(/\s+/g)?a.dialog.alert("输入不能有空格符！",{}):a.dialog.alert("格式错误，请输入整数！",{})}}]}}),module.factory("headSearch",["request",function(e){var t=g_conf.pes.rUrl;return{SearchIntelligent:function(n,a){var r={method:"GET",url:t+"pub/api/SearchIntelligent",params:n,option:{loading:!1}};return e(angular.extend(r,a||{}))}}}]),module.run(["service","headSearch",function(e,t){e.expand("headSearch",function(){return t})}]),module.directive("headnav",function(){return{template:'<header><div ng-class="headMaximizeLock ? \'head-maximize\' : \'head-minimize\'"><div ng-class="param.style"><div class="image-head-rainbow decoration-ic"></div><section class="g-m-w header-area"><div class="minimize-logo"><a ng-href="{{param.logo.href||\'/\'}}"><img ng-src="{{param.logo.small}}" alt="{{param.logo.msg}}" title="{{param.logo.msg}}"></a></div><nav class="minimize-nav"><ul><li ng-repeat="item in navList track by $index" ng-class="item.class"><a ng-href="{{item.href || \'\'}}" target="{{item.target || \'_self\'}}">{{item.name}}</a><div ng-if="item.child.length"><ul><li ng-repeat="c in item.child"><a ng-href="{{c.href || \'\'}}" target="{{c.target || \'_self\'}}">{{c.name}}</a></li></ul></div></li></ul></nav><div class="logo"><a ng-href="{{param.logo.href||\'/\'}}"><img ng-src="{{param.logo.large}}" alt="{{param.logo.msg}}" title="{{param.logo.msg}}"></a></div><div class="top-user-menu-bar" ng-class="{clearminw: user.account}"><top-user-menu user="user" item-list="itemList"></top-user-menu></div><div class="h-sc" ng-controller="headSearchCtrl"><div class="head-search-bar"><div class="enter" ng-click="stopPropagation($event)"><input type="text" class="input" ng-model="scText" ng-keydown="onkeydown($event)" ng-change="matchChange(scSelectVal.value,scText)" placeholder="请输入关键词搜索"><div class="match-kw-v" ng-show="matchReadyLock"><div class="mc-list"><ul><li ng-if="!mcCourseList || !mcCourseList.length">暂无相关内容</li><li ng-repeat="item in mcCourseList track by $index" ng-click="intoDetail(item)" ng-if="$index < cMaxLen" ng-class="{hover: $index + lMaxLen == moveKeyIndex}" ng-mouseenter="mouseenter($index, \'资源\')"><div class="text-of pd-r10"><span class="lab" ng-if="item.t == 10">课程</span> <span class="lab" ng-if="item.t == 20">题库</span> <a class="item-name" ng-bind-html="item.name | titleMatchKw:scText"></a></div></li></ul></div></div></div><a ng-click="goToSearch(scSelectVal.value,scText)" class="submit" title="提交"><i class="fa fa-search" aria-hidden="true"></i></a></div><div class="hot-word"><a ng-href="javascript:void(0);" ng-click="goToSort(item.name)" class="mg-r20" ng-repeat="item in scHotWord">{{item.name}}</a></div></div></section><section class="nav-area"><div class="g-m-w"><div class="n-categories" ng-controller="categoriesCtrl" ng-mouseenter="service.mouseenter(hover)" ng-mouseleave="service.mouseleave(hover)"><div class="dt">全部课程</div><div class="dd" id="by-categories" ng-show="categoriesUnfoldLock || hover.mouseEnterLock"><div class="image-giraffe giraffe-icon"></div><div class="dd-inner"><div class="item" ng-repeat="item in categoriesListStyle1 track by $index" ng-mouseenter="service.mouseenter(item)" ng-mouseleave="service.mouseleave(item)" ng-show="$index<5 || hover.mouseEnterLock"><div class="layer"><h3><a ng-href="goToCategory(item.name)" target="_blank" title="{{item.name}}">{{item.name}}</a></h3><div class="hot-word"><a ng-href="goToCategory(item.name,child.name)" target="_blank" class="text-of" ng-repeat="child in item.child track by $index" ng-show="$index<3" title="{{child.name}}">{{child.name}}</a></div><i>&gt;</i></div><div class="sub" ng-show="item.mouseEnterLock"><div class="inner"><dl class="card" ng-repeat="child in item.child track by $index" ng-show="$index<3"><dt><a ng-href="goToCategory(item.name,child.name)" target="_blank" class="f-r">更多&gt;&gt;</a> <a ng-href="goToCategory(item.name,child.name)" target="_blank" title="{{child.name}}">{{child.name}}</a></dt><dd><a ng-href="goToCategory(item.name,child.name,unit.name)" target="_blank" class="text-of" ng-repeat="unit in child.child track by $index" ng-show="$index<15" title="{{unit.name}}">{{unit.name}}</a></dd></dl><div class="more-srot" ng-show="item.child.length>3"><a ng-href="goToCategory(item.name)" target="_blank" class="f-r">更多分类&gt;&gt;</a>. . .</div></div></div></div><div ng-repeat="list in categoriesListStyle2 track by $index"><div class="big-sort"><a ng-href="goToCategory(item.name)" target="_blank" title="{{list.name}}">{{list.name}}</a></div><div class="item" ng-repeat="item in list.child track by $index" ng-mouseenter="service.mouseenter(item)" ng-mouseleave="service.mouseleave(item)"><div class="layer"><h3><a ng-href="goToCategory(list.name,item.name)" target="_blank" title="{{item.name}}">{{item.name}}</a></h3><i>&gt;</i></div><div class="sub" ng-show="item.mouseEnterLock"><div class="inner"><dl class="card" ng-repeat="child in item.child track by $index" ng-show="$index<4"><dt><a ng-href="goToCategory(list.name,item.name,child.name)" target="_blank" class="f-r">更多&gt;&gt;</a> <a ng-href="goToCategory(list.name,item.name,child.name)" target="_blank" title="{{child.name}}">{{child.name}}</a></dt><dd><a ng-href="goToCategory(list.name,item.name,child.name,unit.name)" target="_blank" class="text-of" ng-repeat="unit in child.child track by $index" ng-show="$index<10" title="{{unit.name}}">{{unit.name}}</a></dd></dl><div class="more-srot" ng-show="item.child.length>4"><a ng-href="goToCategory(list.name,item.name)" target="_blank" class="f-r">更多分类&gt;&gt;</a>. . .</div></div></div></div></div></div></div></div><nav class="nav"><a ng-repeat="item in navList track by $index" ng-href="{{item.href || \'\'}}" target="{{item.target || \'_self\'}}" ng-class="item.class">{{item.name}}</a></nav><div class="extra" ng-show=""><a href="javascript:void(0);" class="icf t-icf">名师认证</a> <a href="javascript:void(0);" class="icf e-icf">真实评价</a> <a href="javascript:void(0);" class="icf r-icf">随时退</a></div></div></section></div></div></header>',restrict:"E",replace:!0,transclude:!0,scope:{itemList:"=itemList",user:"=user",nav:"="},controller:["$rootScope","$scope","$element","$attrs","service",function(e,t,n,a,r){t.service=r,t.catType=parseInt(rcpAid.getCourseCat()),e.$watch("headMaximizeLock",function(e){e&&(t.headMaximizeLock=e)}),e.$watch("categoriesUnfoldLock",function(e){e&&(t.categoriesUnfoldLock=e)}),e.$watch("catDomain",function(e){if(e)switch(e){case"aikexue.com":t.init(2)}}),t.$on("login",function(e,n){n&&t.loginInit()}),t.loginInit=function(){3===t.catType&&(t.navList=[{name:"学习中心",href:rcpAid.getUrl("学习中心"),"class":"key",target:"_blank"},{name:"教学中心",href:rcpAid.getUrl("教学中心",{uid:t.user.tid}),"class":"key",target:"_blank"},{name:"高等教育",href:rcpAid.getUrl("分类",{category:"高等教育"}),"class":"key",target:"_blank"}])},t.init=function(e){if("order"===t.nav)return t.navList=[{name:"首页",href:rcpAid.getUrl("首页"),"class":"key"},{name:"个人空间",href:rcpAid.getUrl("学习中心"),"class":"key",target:"_blank"}],void(t.param={logo:{small:"/rcp-common/imgs/order/head-icon.png",large:"/rcp-common/imgs/icon/head-icon.png",href:"/my-order.html",msg:"我的酷校"},style:""});switch(t.catType){case 3:t.isLogin?t.navList=[{name:"学习中心",href:rcpAid.getUrl("学习中心"),"class":"key",target:"_blank"},{name:"教学中心",href:rcpAid.getUrl("教学中心",{uid:t.user.tid}),"class":"key",target:"_blank"},{name:"高等教育",href:rcpAid.getUrl("分类",{category:"高等教育"}),"class":"key",target:"_blank"}]:t.navList=[{name:"高等教育",href:rcpAid.getUrl("分类",{category:"高等教育"}),"class":"key",target:"_blank"}],t.param={logo:{small:"/rcp-common/imgs/icon/gzmooc-logo.png",large:"/rcp-common/imgs/icon/gzmooc-logo.png",href:DYCONFIG.rcp.rUrl,msg:"酷校 - 首页"},style:""};break;case 2:t.navList=[{name:"首页",href:rcpAid.getUrl("首页"),"class":"key"},{name:"全部课程",href:rcpAid.getUrl("分类"),"class":"key",target:"_blank"},{name:"学习中心",href:rcpAid.getUrl("学习中心"),"class":"key",target:"_blank"}],t.param={logo:{small:"/rcp-common/imgs/icon/aikexue-logo-2.png",large:"/rcp-common/imgs/icon/aikexue-logo.png",href:DYCONFIG.rcp.rUrl,msg:"爱科学"},style:"aikexue-head"};break;default:t.navList=[{name:"首页",href:rcpAid.getUrl("首页"),"class":"key"},{name:"学习中心",href:rcpAid.getUrl("学习中心"),"class":"key",target:"_blank"},{name:"我要吐槽",href:rcpAid.getUrl("我要吐槽"),"class":"key",target:"_blank"}],t.param={logo:{small:"/rcp-common/imgs/icon/book-logo-2.png",large:"/rcp-common/imgs/icon/book-logo.png",href:DYCONFIG.rcp.rUrl,msg:"酷校LOGO·让学习更Cool"},style:""}}},t.init()}]}}),module.directive("topUserMenu",function(){return{template:'<div class="top-user-menu"><div style="font-size:14px;line-height:40px" ng-show="!currentUser.uid"><a ng-href="{{link.login}}" id="login" class="color-cyan pd-l20"><i class="image-login-user-ic"></i>马上登录 </a><span style="color:#ececec;margin:0 8px">| </span><a ng-href="{{link.register}}" class="color-cyan">注册</a></div><div class="menber-link" ng-show="currentUser.uid"><a href="" class="u-info" rel="member_link"><img ng-hide="currentUser.avatar" src="/rcp-common/imgs/face/d-face-1.png" class="face-img" width="40" height="40" rel="user_face" alt="{{currentUser.nickName}}"> <img ng-show="currentUser.avatar" ng-src="{{currentUser.avatar}}" class="face-img" width="40" height="40" rel="user_face" alt="{{currentUser.nickName}}"> <span class="name" rel="user_name" title="{{currentUser.nickName}}" ng-bind="currentUser.nickName"></span> <i class="x-arrow-dowm">&gt;</i></a><div class="u-panel"><div class="tup-box"><div class="tup-info" rel="user_info_box"><div class="user-head" rel="user_face_box"><a ng-href="{{link.setting}}"><img ng-hide="currentUser.avatar" src="/rcp-common/imgs/face/d-face-1.png" width="96" height="96" class="face-img" rel="user_face" alt="{{currentUser.nickName}}"> <img ng-show="currentUser.avatar" ng-src="{{currentUser.avatar}}" width="96" height="96" class="face-img" rel="user_face" alt="{{currentUser.nickName}}"></a></div><div class="user-identity"><p class="user-name text-of"><a href="" rel="user_name" title="{{currentUser.nickName}}" ng-bind="currentUser.nickName"></a></p><p class="attestation-un" ng-class="{\'attestation\':attestation==\'已认证\'}"><i class="image-attestation-yellow"></i> <span>{{attestation}}</span></p></div><div class="clear"></div></div><div class="tup-operate"><div class="card-sets"><a href="{{link.applySpaceUrl}}" class="key f-l"><i class="image-attestation"></i> <span class="text-4f">认证管理</span> </a><a href="{{link.setting}}" target="_blank" class="key f-l"><i class="image-settings"></i> <span class="text-4f">设置</span> </a><a href="" class="key f-r" ng-click="logout()"><i class="image-logout"></i> <span class="text-4f">退出</span></a></div><div class="card-links"><a ng-repeat="item in itemList" ng-href="{{item.href || \'\'}}" ng-class="item.name == \'...\' ? \'disabled key \'+item.icon : \'key \'+item.icon"><i></i> <span>{{item.name}}</span></a></div></div></div></div></div></div>',restrict:"E",replace:!0,transclude:!0,scope:{itemList:"=itemList",user:"=user"},controller:["$rootScope","$scope","$timeout","$location","service",function(e,t,n,a,r){t.$watch("itemList",function(e){if(e){var n=t.itemList.length,a=n%3;if(a)for(var r=3-n%3+n,i=n;r>i;i+=1)e.push({name:"..."})}},!0),t.logout=function(){var e=rcpAid.getUrl("首页");location.href=rcpAid.getUrl("退出",{url:encodeURIComponent(e)})},t.$on("login",function(e,n){n.uid&&t.loginInit()}),t.loginInit=function(){t.currentUser=e.currentUser,t.currentUser.certification&&(t.attestation="已认证")},t.init=function(){var e=rcpAid.getNoTokenUrl();t.link={login:rcpAid.getUrl("登录",{url:encodeURIComponent(e)}),register:rcpAid.getUrl("注册",{url:encodeURIComponent(e)}),applySpaceUrl:rcpAid.getUrl("实名认证"),setting:rcpAid.getUrl("个人设置",{url:window.location.href})},t.attestation="未认证"},t.init()}]}}),module.controller("categoriesCtrl",["$rootScope","$scope","service",function(e,t,n){function a(e){switch(e){case 2:t.categoriesListStyle2=r||[];break;default:t.categoriesListStyle1=r||[]}}t.service=n,t.hover={},t.catType=rcpAid.getCourseCat(),t.byCategories=function(){t.byCategoriesLoading=!0,a(t.catType)},t.listenerMember={byCategories:{node:"#by-categories",callback:t.byCategories}};var r;t.goToCategory=function(){var e=[].slice;return rcpAid.getUrl("分类",{tags:e.call(arguments,0).join(",")})}}]),module.directive("searchDir",function(){return{template:'<div class="h-sc"><div class="head-search-bar"><div class="enter" ng-click="stopPropagation($event)"><input type="text" class="input" ng-model="scText" ng-keydown="onkeydown($event)" ng-change="matchChange(scSelectVal.value,scText)" placeholder="请输入关键词搜索"><div class="match-kw-v" ng-show="matchReadyLock"><div class="mc-list"><ul><li ng-repeat="item in mcCategoryList track by $index" ng-if="$index < lMaxLen" ng-class="{hover: $index == moveKeyIndex}" ng-mouseenter="mouseenter($index,\'类\')" ng-click="matchGoToCategory(item.tag,scText)"><div class="text-of"><a href="javascript:;">{{text}}</a> 在 <a href="javascript:;" class="item-name color-cyan">{{item.tag}}</a> 分类中搜索</div></li></ul><div style="margin:0 10px;border-top:1px solid #dfdfdf" ng-if="mcCourseList.length && mcCategoryList.length"></div><ul><li ng-if="!mcCourseList || !mcCourseList.length">暂无相关内容</li><li ng-repeat="item in mcCourseList track by $index" ng-click="intoDetail(item)" ng-if="$index < cMaxLen" ng-class="{hover: $index + lMaxLen == moveKeyIndex}" ng-mouseenter="mouseenter($index,\'资源\')"><div class="text-of"><span class="lab" ng-if="item.t == 10">课程</span> <span class="lab" ng-if="item.t == 20">题库</span> <a href="javascript:;" class="item-name" ng-bind-html="item.name|titleMatchKw:scText"></a></div></li></ul></div></div></div><a ng-click="goToSearch(scSelectVal.value,scText)" class="submit" title="提交"><i class="fa fa-search" aria-hidden="true"></i></a></div><div class="hot-word"><a href="" class="mg-r20" ng-repeat="item in scHotWord" ng-click="goToSort(item.name)">{{item.name}}</a></div></div>',restrict:"E",replace:!0,transclude:!0,scope:{hot:"="},controller:"headSearchCtrl"}}),module.controller("headSearchCtrl",["$rootScope","$scope","$document","$element","service","headSearch",function(e,t,n,a,r,i){function s(){t.scText="",d()}function o(){k=!0,t.KeyDownIndex=t.moveKeyIndex,u()}function c(){"number"!=typeof t.moveKeyIndex?t.moveKeyIndex=0:t.moveKeyIndex=(t.moveKeyIndex+1)%t.aMaxLen,o()}function l(){"number"!=typeof t.moveKeyIndex?t.moveKeyIndex=t.aMaxLen-1:t.moveKeyIndex=t.moveKeyIndex<0?t.aMaxLen-1:t.moveKeyIndex-1,o(),f(t.scText.length)}function u(){var e,n=t.KeyDownIndex,a=t.lMaxLen;return t.scTag=void 0,a>n&&(t.scText=t.text),n>=a&&(e=t.mcCourseList[n-t.lMaxLen],e&&(t.scText=e.name)),e}function d(e){t.matchReadyLock=!1,e&&(n.unbind("click"),t.$digest())}function h(){n.unbind("click").bind("click",function(){d("digest")}),t.matchReadyLock=!0}function m(){t.matchReadyLock&&(clearTimeout(b),b=setTimeout(function(){d("digest")},300))}function f(e){var t=a.find('input[ng-model="scText"]').get(0);if("selectionStart"in t&&(t.selectionStart=e,t.selectionEnd=e),"createTextRange"in t){var n=t.createTextRange();n.moveStart("character",e),n.collapse(!0),n.select()}}function g(e,n){t.inSort&&!angular.isArray(e)||angular.forEach(e,function(e){return t.inSort?!1:void(n(e)||angular.isArray(e.child)&&e.child.length&&(g(e.child,n),v("push",e.name)))})}function p(e,n){switch(t.inSort=!1,v("clear"),g(e,function(e){return t.inSort=e.name===n,t.inSort&&v("push",e.name),t.inSort}),t.inSort){case!0:v("splice",n);break;default:v("clear")}return t.categorySelect}function v(e,n){var a=t.categorySelect;switch(e){case"clear":a.splice(0,a.length);break;case"push":a.push(n);break;case"splice":a.splice(0,$.inArray(n,a))}}function y(e,t){r.dialog.alert(t),console[e](t)}function _(e){var t=[];if(e.length)for(var n=0,a=e.length;a>n;n++)t.push({id:e[n].hasOwnProperty("id")?e[n].id:"",name:e[n].hasOwnProperty("title")?e[n].title:"",t:e[n].hasOwnProperty("type")?e[n].type:""});return t}t.scHotWord=[],t.scSelect=[{name:"所有分类",value:"",fixLock:!0},{name:"课程",value:10},{name:"题库",value:20}],t.scSelectVal=t.scSelect[0],t.onkeydown=function(e){switch(e.stopPropagation(),e.keyCode){case 13:t.scText||(t.scText=$(".head-search-bar input").eq(0).val());var n=t.KeyDownIndex,a=t.lMaxLen;"number"==typeof n&&n>=0&&a>n&&t.scTag?t.matchGoToCategory(t.scTag,t.scText):n>=0&&t.matchReadyLock?location.href=rcpAid.getUrl("课程详情",{cid:t.mcCourseList[n].id}):t.goToSearch(t.scSelectVal.value,t.scText);break;case 38:l();break;case 40:c();break;default:k=!1,t.moveKeyIndex=void 0,t.KeyDownIndex=void 0,t.scTag=void 0}};var k,b;a.find('input[ng-model="scText"]').unbind("focus").bind("focus",h),a.find('input[ng-model="scText"]').unbind("blur").bind("blur",m),t.mouseenter=function(e,n){switch(n){case"类":t.moveKeyIndex=e;break;case"资源":t.moveKeyIndex=e+t.lMaxLen}},t.goToSearch=function(e,t){s(),location.href=rcpAid.getUrl("搜索",{type:e,query:t?encodeURIComponent(t):t})},t.goToSort=function(e){s(),location.href=rcpAid.getUrl("分类",{tags:e})},t.stopPropagation=function(e){e.stopPropagation()},t.matchChange=function(e,n){if(!k){if(d(),!n)return t.mcCategoryList=[],void(t.mcCourseList=[]);t.text=n,i.SearchIntelligent({key:n,courseType:e||null,limit:10}).then(function(e){t.scText&&(t.matchReadyLock=!0,t.mcCourseList=_(e.data.courses||[]),t.mcCategoryList=[],t.lMaxLen=t.mcCategoryList.length>3?3:t.mcCategoryList.length,t.cMaxLen=t.mcCourseList.length-t.lMaxLen,t.aMaxLen=t.lMaxLen+t.cMaxLen,t.mcCourseList.length||t.mcCategoryList.length||d())},function(e){y("错误代码："+e.data.data.code)})}},t.$watch("scSelectVal.value",function(){t.matchChange(t.scSelectVal.value,t.scText)}),t.matchGoToCategory=function(t,n){if(!e.allTagCategroy||!e.allTagCategroy.length)return void y("error","获取分类数据失败");var a=p(e.allTagCategroy,t).reverse().join(",");a?(s(),location.href=rcpAid.getUrl("分类",{tags:a,query:n})):y("error","找不到这个分类，请检查接口数据")},t.categorySelect=[],t.intoDetail=function(e){e.hasOwnProperty("id")&&(location.href=rcpAid.getUrl("课程详情",{cid:e.id}))}}]),module.directive("tailnav",function(){return{template:'<footer><section class="footer" id="footer"><div class="g-m-w"><div class="copyright"><p>广州市大洋信息技术股份有限公司 版权所有</p><p>Copyright © 2015 ITDAYANG. All Rights Reserved.</p><p>{{caseNumber}}</p></div><div class="footer-link"><a href="http://www.itdayang.com/about.html" target="_blank">关于我们</a> <span>- </span><a href="http://www.itdayang.com/contact.html" target="_blank">联系我们</a> <span>- </span><a href="javascript:;" ng-click="atBuilding()">法律条款</a> <span>- </span><a href="javascript:;" ng-click="atBuilding()">帮助中心</a> <span>- </span><a href="javascript:;" ng-click="atBuilding()">学校申请加入</a> <span>- </span><a href="javascript:;" ng-click="atBuilding()">机构申请加入</a> <span>- </span><a href="javascript:;" ng-click="atBuilding()">意见反馈</a></div><div class="clear"></div></div></section></footer>',restrict:"E",replace:!0,transclude:!0,scope:{data:"=data"},controller:["$scope","service",function(e,t){e.catType=rcpAid.getCourseCat();var n=DYCONFIG.domain||[];angular.forEach(n,function(t){t.domain===location.host&&(e.caseNumber=t.domainNum)}),e.atBuilding=function(){t.dialog.alert("正在建设中...")}}]}}),module.filter("titleMatchKw",["$sce",function(e){return function(t,n){var a="<b>"+n+"</b>",r=/([\[\]\(\)\{\}\*\?\+\^\$\.\|\\])/gi,i=n.replace(r,"\\$1");return t=t.replace(new RegExp(i,"ig"),a),e.trustAsHtml(t)}}]),function(){function e(){var r=document.getElementById("footer");if(r){var i=document.documentElement.scrollHeight-1||document.body.scrollHeight-1,s=document.documentElement.clientHeight||document.body.clientHeight;a=s>=i?1:2,a!==n&&(s>=i?(t(r.parentNode,{height:r.offsetHeight+"px"}),t(r,{position:"absolute",width:"100%",bottom:0,left:0})):(t(r.parentNode,{height:r.offsetHeight+"px"}),t(r,{position:"",width:"100%",bottom:0,left:0}))),n=s>=i?1:2}setTimeout(e)}if(!window.fixedFooterFlag){window.fixedFooterFlag=!0;var t=function(e,t){for(k in t)e.style[k]=t[k]},n=0,a=1;e()}}(),!module)var module=angular.module("RCP",[]);module.directive("emptyTip",function(){return{template:'<div class="empty-tip" ng-style="boxStyle"><style type="text/css">.empty-tip{text-align:center;padding:30px 0}.empty-tip .msg{padding:10px 0 0;color:#999}.empty-tip .img{width:100%}</style><div ng-show="theme==1"><img src="/rcp-common/imgs/common/no-data.png" class="img" ng-style="imgStyle"></div><div ng-show="!theme"><img src="/rcp-common/imgs/common/icon-cloud.png" ng-style="imgStyle"></div><div ng-show="!theme" class="msg"><span ng-hide="showLogin">{{msg}}</span> <a href="" style="color:#00f" ng-show="showLogin">请先登录</a></div></div>',restrict:"E",replace:!0,transclude:!0,scope:{c:"="},controller:["$scope","service",function(e,t){e.msg="暂无数据",e.c&&angular.forEach(e.c,function(t,n){e[n]=t}),"请先登录"===e.msg&&(e.showLogin=!0,e.dialog=function(e){t.dialog.alert(e)})}]}}),module.directive("sidebar",function(){return{restrict:"E",template:'<div class="sidebar"><ul><li ng-class="sidebar.cur" ng-repeat="sidebar in sidebarList" ng-click="barClick(sidebar)"><i ng-class="sidebar.icon"></i> <a ng-href="{{sidebar.href}}">{{sidebar.name}}</a></li></ul></div>',replace:"true",scope:{},controller:["$scope","$element","$attrs","$location","$rootScope",function(e,t,n,a,r){function i(){return a.path()}function s(){var t,n=!1,a=i();if(angular.forEach(e.sidebarList,function(e){e.cur="",e.icon=o+e.tag,t=e.href,t&&(t=t.substr(1),t==a&&(e.cur="cur",e.icon=o+e.tag+c,l=e.tag,n=!0))}),!n){var r=e.sidebarList[0];for(var s in u)if(u.hasOwnProperty(s)&&0==a.indexOf(s)){angular.forEach(e.sidebarList,function(e){u[s]==e.tag&&(r=e)});break}r.cur="cur",r.icon=o+r.tag+c}}var o="image-",c="-down",l="",u={"/paper-detail":"shijuan"};switch(n.sidebarType){case"student":o="image-cat-",e.sidebarList=[{tag:"s1",cur:"",icon:"",name:"我的课程",href:"#/myCourses"},{tag:"s3",cur:"",icon:"",name:"我的圈子",href:"#/myCircle"},{tag:"s4",cur:"",icon:"",name:"学习风格",href:"#/myKnowledge"},{tag:"s5",cur:"",icon:"",name:"我的学分",href:"#/myScore"},{tag:"s6",cur:"",icon:"",name:"账号信息",href:"#/myAccont"},{tag:"s7",cur:"",icon:"",name:"教育信息",href:"#/myEducation"}];break;case"teacher":o="image-bar-t-",e.sidebarList=[{tag:"kecheng",cur:"",icon:"",name:"课程管理",href:"#/coursesManager"},{tag:"quanxian",cur:"",icon:"",name:"权限管理",href:"#/rightManager"},{tag:"xuesheng",cur:"",icon:"",name:"学生管理",href:"#/studentManager"},{tag:"chengji",cur:"",icon:"",name:"成绩管理",href:"#/scoreManager"},{tag:"shijuan",cur:"",icon:"",name:"试卷批改",href:"#/paperManager"},{tag:"zhanghao",cur:"",icon:"",name:"账号信息",href:"#/acountInfo"}]}e.barClick=function(e){e.tag==l&&r.$broadcast("bar-repeat-click",e.tag),l=e.tag},s(),r.$on("$locationChangeSuccess",function(){s()})}]}}),module.directive("defaultImg",function(){return{template:'<div class="default-img"><img class="hide" ng-src="{{src}}" ng-style="{{conf.style}}" alt="{{alt}}"></div>',restrict:"E",replace:!0,transclude:!0,scope:{alt:"=",src:"=src",conf:"=conf"},controller:["$scope","$element","$attrs",function(e,t,n){var a=e.conf||{},r=t.find("img");a.width&&(t.width(a.width),r.width(a.width)),a.height&&(t.height(a.height),r.height(a.height)),r.on({load:function(){r.removeClass("hide")}}),e.$watch("src",function(e,t){e||r.addClass("hide")})}]}}),module.directive("tipsTool",["$timeout",function(e){var t={};return{template:'<div class="tooltip"><div class="tip"><p class="text"><span ng-bind="data.title_top"></span><span class="content" ng-bind="data.info_top"></span></p><p class="text"><span ng-bind="data.title_bottom"></span><span class="content mutil" ng-bind="data.info_bottom"></span></p></div></div>',restrict:"E",replace:!0,transclude:!0,scope:{mode:"=",modeId:"=",data:"="},link:function(e,n,a){function r(e,t,n){for(var a=e.length,r=0,i=0;a>i;i++)r+=e.charCodeAt(i)>127||94==e.charCodeAt(i)?n:t;
return r}function i(e,a){e.css("display","block");var r=function(){s(0,null,e),a&&(t[a]=!0)&&console.log(a),n.off("mouseleave",r)};n.off("mouseleave"),n.on("mouseleave",r)}function s(e,a,r){return r=r||n.find(".tip"),0==e?void r.css("display",""):void(1==e?i(r):2!=e||t[a]||i(r,a))}var o=400,c=9,l=12;e.$watch("data",function(t,a){var i=t,u=r(i.info_top,c,l),d=r(i.info_bottom,c,l),h=u>d?u:d;h=o>h?h:o,n.find(".mutil").width(h),s(e.mode,e.modeId)})}}}]),module.factory("course",["request",function(e){var t=DYCONFIG.course.rUrl;return{getCourseDetail:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"pub/api/loadCourse",params:n};return e(angular.extend(r,a||{}))},getTeacherCourses:function(n,a){n.token=rcpAid.getToken(),n.isSelf=1;var r={method:"GET",url:t+"pub/api/searchCourse",params:n};return e(angular.extend(r,a||{}))},joinFreeCourse:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"usr/api/joinCourse",params:n};return e(angular.extend(r,a||{}))},searchCourse:function(n,a){var r={method:"GET",url:t+"pub/api/searchCourse",params:n};return e(angular.extend(r,a||{}))},verifyCourse:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"usr/api/verifyCourse",params:n};return e(angular.extend(r,a||{}))},createCourse:function(n,a,r){n.token=rcpAid.getToken();var i={method:"POST",url:t+"usr/api/createCourse",params:n,data:r};return e(angular.extend(i,a||{}))},getStudentCourse:function(n,a){n.token=rcpAid.getToken(),n.isSelf=10;var r={method:"GET",url:t+"pub/api/searchCourse",params:n};return e(angular.extend(r,a||{}))},releaseCourse:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"usr/api/releaseCourse",params:n};return e(angular.extend(r,a||{}))},saveCourseData:function(n,a){var r={};r.token=rcpAid.getToken();var i={method:"POST",url:t+"usr/api/updateCourse",params:r,data:n};return e(angular.extend(i,a||{}))},cancelCourse:function(n,a){n.token=rcpAid.getToken();var r={method:"POST",url:t+"usr/api/cancelCourse",params:n};return e(angular.extend(r,a||{}))},getListGroup:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"pub/api/listGroup",params:n};return e(angular.extend(r,a||{}))},getAllTags:function(t,n){t.token=rcpAid.getToken();var a={method:"POST",url:DYCONFIG.pes.rUrl+'pub/api/page/GetPage?keys=[{"key":"p_classifi"}]',params:t};return e(angular.extend(a,n||{}))},updateArticleExt:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"usr/api/updateExt",params:n};return e(angular.extend(r,a||{}))},getArticleExt:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"pub/api/listArtExt",params:n};return e(angular.extend(r,a||{}))},loadRecord:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"pub/api/loadRecord",params:n};return e(angular.extend(r,a||{}))},listPaperCorrect:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"usr/api/listPaperCorrect",params:n};return e(angular.extend(r,a||{}))},Publish:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"usr/api/publish",params:n};return e(angular.extend(r,a||{}))}}}]),module.run(["service","course",function(e,t){e.expand("course",function(){return t})}]),module.controller("courseManagerCtrl",["$scope","$rootScope","service","course","$location","$timeout","$window",function(e,t,n,a,r,i,s){function o(){rcpAid.isLogin&&t.currentUser&&t.currentUser.uid?i(function(){e.getResList(e.curTag,e.filterKey,e.curStatus)}):e.$on("login",function(t,a){return a?void e.getResList(e.curTag,e.filterKey,e.curStatus):void n.common.toLogin()})}function c(e,t){var n="";return 10==e?n="课程详情":20==e&&(n="题库详情"),rcpAid.getUrl(n,{cid:t})}function l(e,t){var n=10==e?"创建课程":20==e?"创建题库":"";return rcpAid.getUrl(n,{id:t})}function u(t,r){a.releaseCourse({cid:r.id}).then(function(t){return t.code?void n.dialog.alert("错误: "+t.code):(n.dialog.alert("课程已发布,正在审核中"),void e.getResList(e.curTag,e.filterKey,e.curStatus,e.curType))},function(e){n.dialog.alert("错误: "+e.code)})}function d(t,r){a.cancelCourse({cid:r.id}).then(function(t){return t.code?void n.dialog.alert("错误: "+t.code):(n.dialog.alert("课程已下架"),void e.getResList(e.curTag,e.filterKey,e.curStatus))},function(e){n.dialog.alert("错误: "+e.code)}),e.hideFrameDialog()}function h(){var t=e.pageargs.filter,n=e.pageargs.tag,a=t||0!=n?1:0;e.curEmptyTip=v[a],e.isEmpty=!0,e.loading=!1}function m(t){if(!t.data.allCount||t.code)return h(),t.code&&n.dialog.alert("错误: "+t.code),!1;e.resourceList=t.data.courses;for(var a,r=e.resourceList.length,i=e.resourceList,s=0;r>s;s++)a=i[s],a.imgs&&a.imgs[0]?a.imgUrl=a.imgs[0]:a.imgUrl="",a.start_time||(a.start_time="无"),a.end_time||(a.end_time="无"),a.operationList=p[a.status].operations,a.statusIcon=p[a.status].icon,a.detailUrl=c(a.type,a.id),a.extra&&a.extra.reason&&(100==a.status||300==a.status||500==a.status)&&(a.tips={title_top:"课程状态:",title_bottom:p[a.status].reasonTip,info_top:p[a.status].name,info_bottom:a.extra.reason});return e.isEmpty=!1,e.loading=!1,!0}var f={};f.host="*",f.sort=1,f.mode=5,e.loading=!0,e.isEmpty=!1,e.toolList=[{tag:0,name:"全部",status:1},{tag:1,name:"已上架",status:100},{tag:2,name:"未发布",status:20},{tag:3,name:"待审核",status:200},{tag:4,name:"审核未通过",status:500},{tag:5,name:"已下架",status:300}],e.curTag=e.toolList[0].tag,e.curStatus=e.toolList[0].status,e.toolList[0].cur="cur-2",o(),e.$on("bar-repeat-click",function(t,n){"kecheng"==n&&e.getResList(e.curTag,e.filterKey,e.curStatus)}),e.createCourse=function(e){var t=rcpAid.getUrl("创建课程",{type:10});s.open(t)},e.onkeydown=function(t){13===t.keyCode&&e.getResList(e.curTag,e.filterKey,e.curStatus)},e.getResource=function(t){e.curTag=t.tag,e.curStatus=t.status,angular.forEach(e.toolList,function(e){e.cur=""}),t.cur="cur","0"==t.tag?t.cur="cur-2":t.cur="cur",e.getResList(e.curTag,e.filterKey,e.curStatus)},e.showFrameDialog=function(t){e.dialogOK=t||angular.noop,e.showDialog=!0},e.hideFrameDialog=function(){e.showDialog=!1},e.doOperation=function(t,n){0!=t.tag&&1!=t.tag&&(2===t.tag?e.showFrameDialog(function(){d(t,n)}):4===t.tag&&u(t,n))};var g=[{tag:0,name:"开始导学",style:"btn-teach"},{tag:1,name:"马上编辑",style:"",getUrl:l},{tag:2,name:"下架课程",style:""},{tag:3,name:"删除课程",style:""},{tag:4,name:"马上发布",style:""},{tag:4,name:"重新发布",style:""}],p={20:{name:"未发布",reasonTip:"",operations:[g[1],g[4]],icon:"image-un-pub"},100:{name:"已上架",reasonTip:"上架理由:",operations:[g[1],g[2]],icon:""},200:{name:"待审核",reasonTip:"",operations:[g[1]],icon:"image-un-appro"},300:{name:"已下架",reasonTip:"下架理由:",operations:[g[1],g[4]],icon:"image-un-used"},500:{name:"审核未通过",reasonTip:"未通过理由:",operations:[g[1],g[4]],icon:"image-un-pass"}};e.getResList=function(t,n,a){e.loading=!0,t>=0&&6>t&&(e.pageargs={pn:1,ps:5,pl:5,tag:t,filter:n,status:a,type:10})};var v=["你还没有创建任何内容哦","这里没有相关课程哦"];e.curEmptyTip=v[0];var y=0;e.pagefn=function(e,t){f.page=e.pn,f.pageCount=e.ps,f.type="0"==e.type?void 0:e.type,f.k=e.filter,f.status=0==e.status?void 0:e.status,f.sort=3==e.tag?-8:-1,y++;var r=y;a.getTeacherCourses(f).then(function(e){r==y&&(m(e),e.pa={total:e.data.allCount},t(e))},function(e){h(),console.error("获取课程失败",e),e.data&&e.data.data&&301!=e.data.data.code&&n.dialog.alert("获取课程失败")})}}]),module.directive("landscapeList",function(){return{template:'<div class="landscape-list"><style type="text/css">.landscape-list{border:1px solid #f7f7f7;padding:11px 6px 11px 16px}.landscape-list .landscape-content{font-size:14px}.landscape-list .landscape-content .ls-item,.landscape-list .landscape-content .ls-more,.landscape-list .landscape-content .ls-title{display:inline-block}.landscape-list .landscape-content .ls-title{color:#666;vertical-align:top}.landscape-list .landscape-content .ls-title>span{margin-left:1px;vertical-align:middle}.landscape-list .landscape-content .ls-title>i{margin-top:1px}.landscape-list .landscape-content .ls-more{float:right;width:54px;height:22px;line-height:22px;font-size:12px;color:#8c8c8c;border:1px solid #f7f7f7;border-radius:3px;text-align:center;cursor:pointer}.landscape-list .landscape-content .ls-more>i{margin-top:-2px}.landscape-list .landscape-content .ls-item{width:84%}.landscape-list .landscape-content .ls-item>p{display:inline-block;width:150px;margin-left:35px;color:#1f211e}.landscape-list .landscape-content .ls-item>p>span{display:inline-block;max-width:150px;white-space:nowrap;-o-text-overflow:ellipsis;text-overflow:ellipsis;overflow:hidden;cursor:pointer}.landscape-list .landscape-content .ls-item .m-t-large{margin-top:25px}.landscape-list .landscape-content .ls-item .active{color:#07afa9}@media screen and (max-width:1240px){.landscape-list .landscape-content .ls-item>p{width:115px}.landscape-list .landscape-content .ls-item>p>span{max-width:115px}}</style><div class="landscape-content"><div class="ls-title"><i class="fa fa-file-text-o" aria-hidden="true"></i> <span>{{ldTitle || \'课程\'}}</span></div><div class="ls-item" ng-show="loaded && list.length"><p ng-repeat="item in list" ng-class="{active: $index == curItemIndex, \'m-t-large\': $index >= rowNum}" ng-show="showMore || $index < rowNum"><span title="{{item.name}}" ng-bind="item.name" ng-click="click(item, $index);"></span></p></div><div class="ls-more" ng-click="toggle()" ng-show="list.length > 1"><span ng-bind="showMore ? \'收起\' : \'展开\'"></span> <i class="fa" aria-hidden="true" ng-class="{\'fa-chevron-up\': showMore, \'fa-chevron-down\': !showMore}"></i></div><loader-ui show="loaded"></loader-ui><empty-tip ng-show="loaded && !list.length"></empty-tip></div></div>',restrict:"E",replace:!0,transclude:!0,scope:{list:"=",loaded:"=",itemClick:"=",ldTitle:"="},controller:["$scope",function(e){e.rowNum=4,e.showMore=!1,e.curItemIndex=0,e.click=function(t,n){e.curItemIndex=n,e.itemClick&&e.itemClick(t.id)},e.toggle=function(){if(e.showMore=!e.showMore,!e.showMore&&e.curItemIndex>=e.rowNum){var t=Math.floor(e.curItemIndex/e.rowNum);t*=e.rowNum;var n=t+e.rowNum;n=n<e.list.length?e.rowNum:e.list.length%e.rowNum;var a=e.list.splice(t,n);Array.prototype.unshift.apply(e.list,a),e.curItemIndex=e.curItemIndex%e.rowNum}}}]}}),module.directive("headSelector",function(){return{template:'<div class="head-selector"><style type="text/css">.head-selector{display:inline-block;position:relative;text-align:center;cursor:pointer}.head-selector>span>i.fa{margin-left:7px}.head-selector .hs-options{position:absolute;border:1px solid #f7f7f7;background:#fff;z-index:10}.head-selector .hs-options>li{width:98px;line-height:30px;cursor:pointer}.head-selector .hs-options .hover-bg:hover{background:#fcf8e8}.head-selector .hs-options .active{background:#02c0b9;color:#fff}</style><span ng-click="toggle();">{{content}}<i class="fa fa-caret-down" aria-hidden="true" ng-class="{\'fa-caret-down\': !showOptions, \'fa-caret-up\': showOptions}"></i></span><ul class="hs-options" ng-show="showOptions"><li ng-repeat="option in options" ng-click="setValue(option, $index);" ng-class="{\'active\': curSelectIndex == $index, \'hover-bg\': curSelectIndex != $index}">{{option.name}}</li></ul></div>',restrict:"E",replace:!0,transclude:!0,scope:{content:"=",config:"="},controller:["$scope","$timeout",function(e,t){var n=e.config||{};e.options=n.options||[],e.autoClose=angular.isUndefined(n.autoClose)?!0:n.autoClose,e.changeCb=n.changeCb,e.showOptions=!1,e.curSelectIndex=0,e.config&&(e.config.setSelect=function(t){e.curSelectIndex=t}),e.setValue=function(n,a){e.curSelectIndex!==a&&(e.changeCb&&t(function(){e.changeCb(n)}),e.curSelectIndex=a,e.toggle())},e.toggle=function(){e.showOptions=!e.showOptions,e.showOptions&&e.autoClose?$(document).on("click",a):e.autoClose&&$(document).off("click",a)};var a;e.autoClose&&(a=function(n){var r=$(".head-selector");r.is(n.target)||0!==r.has(n.target).length||(t(function(){e.showOptions=!1}),$(document).off("click",a))})}],link:function(e,t){var n=t.find(".hs-options");n.css("left",(t.width()-100)/2)}}}),module.factory("examReq",["request",function(e){var t=DYCONFIG.course.rUrl;return{getListGroup:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"pub/api/listGroup",params:n};return e(angular.extend(r,a||{}))},getListItemL:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"pub/api/listItemL",params:n};return e(angular.extend(r,a||{}))},answerPaper:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"usr/api/answer",params:n,option:{loading:!1}};return e(angular.extend(r,a||{}))},startAnswer:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"usr/api/startAnswer",params:n};return e(angular.extend(r,a||{}))},doneAnswer:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"usr/api/doneAnswer",params:n};return e(angular.extend(r,a||{}))},listExam:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"usr/api/listExam",params:n};return e(angular.extend(r,a||{}))},publishAns:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"usr/api/publish",params:n};return e(angular.extend(r,a||{}))},correctPaper:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"usr/api/correct",params:n};return e(angular.extend(r,a||{}))},listCourseRef:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"pub/api/listRef",params:n};return e(angular.extend(r,a||{}))},createPaper:function(n,a){n.token=rcpAid.getToken();var r={method:"GET",url:t+"art/api/create",params:n};return e(angular.extend(r,a||{}))},insertTest:function(n,a){n.params.token=rcpAid.getToken();var r={method:"POST",url:t+"usr/api/upsertTest",params:n.params,data:n.data};return e(angular.extend(r,a||{}))}}}]),module.run(["service","examReq",function(e,t){e.expand("examReq",function(){return t})}]),module.controller("paperManagerCtrl",["$scope","$timeout","$location","service","course","examReq",function(e,t,n,a,r,i){function s(n){if(n.courses){var a=n.courses,r=!1;0==e.courseList.length&&(r=!0),angular.forEach(a,function(t){e.courseList.push({id:t.id,name:t.title})}),r&&e.courseList.length>0&&t(function(){e.courseClick(e.courseList[0].id)})}}function o(){var n=50;r.getTeacherCourses({status:100,type:10,page:d,pageCount:n}).then(function(a){return e.courseLoaded=!0,a&&a.data?(s(a.data),a.data.allCount&&a.data.allCount>d*n&&(d+=1,t(function(){o()})),void(a.data.allCount||0!=e.courseList.length||t(function(){e.pagerLoaded=!0}))):void console.error("试卷批改，获取课程数据返回空",a)},function(t){e.courseLoaded=!0,console.error("试卷批改，课程数据获取失败",t),a.dialog.alert("课程数据获取失败")})}function c(n){e.curCourseId!==n&&(e.pagerTypeSelector.setSelect&&(e.curPagerType=e.pagerTypeSelector.options[0].value,e.pagerTypeSelector.setSelect(0)),e.curCourseId=n,t(function(){e.pagerPageFn()}))}function l(t){if(t)for(var n=e.pagerTypeSelector.options,a=0,r=n.length;r>a;a++)if(n[a].value==t)return n[a].name;return console.log("[error]","类型转换成名称错误，无法识别的类型",e.pagerTypes,t),""}function u(t){function n(e){if(!r){r={};var n=t.count||{};for(var a in n)if(n.hasOwnProperty(a)&&n[a])for(var s in n[a])r[s]=n[a][s];console.log("pager data count info",r)}var o=r[e]||{},c={join:i,submit:o.submitted||0};return c.score=c.submit-(o.notc||c.submit),c}var a=e.pagerList;if(a.length=0,!t||!t.iteml)return void console.log("[error]","欲处理的试卷数据为空",t);var r,i;i=t.course&&t.course[0]&&t.course[0].joined||0;var s,o,c,u,d,h=0;for(var m in t.iteml)if(t.iteml.hasOwnProperty(m)){h++,s=t.iteml[m];for(var f=0,g=s.length;g>f;f++)if(o=s[f],c=o.beg&&o.beg.c&&o.beg.c.title||"数据获取错误",u=o.items,Array.isArray(u))for(var p=0,v=u.length;v>p;p++)o=u[p],o=o&&o.c||{},d=n(o.aid),a.push({name:o.title||"",type:l(o.type),location:c,submit:d.submit+"/"+d.join,score:d.score+"/"+d.submit,aid:o.aid||"",tid:o.tid||""});else console.log("[error]","课程或章节下试卷获取错误",o,u)}(0==h||h>1||t.course&&t.course.length!=h)&&console.log("[error]","返回的试卷所属的课程过多","count",h,"courses count",t.course.length)}e.courseLoaded=!1,e.courseList=[],e.courseClick=function(e){c(e)};var d=1;o(),e.pagerLoaded=!1,e.pagerList=[],e.changePagerType=function(n){e.curPagerType=n.value,t(function(){e.pagerPageFn()})},e.pagerTypeSelector={options:[{name:"全部",value:"0"},{name:"练习",value:"e_exercise"},{name:"试卷",value:"e_paper"},{name:"考试",value:"e_test"}],changeCb:e.changePagerType},e.curPagerType=e.pagerTypeSelector.options[0].value,e.toScore=function(t,a){n.url("/paper-detail/"+t+"/"+e.curCourseId+"/"+(a?a:"null"))},e.pagerPageFn=function(t,n){e.pagerLoaded=!1;var r={ret_count:1};e.curPagerType&&"0"!==e.curPagerType&&(r.ctype=e.curPagerType),r.cids=e.curCourseId,i.listCourseRef(r).then(function(t){return e.pagerLoaded=!0,t&&t.data?void u(t.data):void console.log("[error]","获取试卷信息返回数据为空",t)},function(t){e.pagerLoaded=!0,console.log("[error]","获取试卷信息失败",t),t.data&&t.data.data&&1==t.data.data.code||a.dialog.alert("获取试卷信息失败")})},t(function(){e.pagerPageFn()})}]),module.directive("highcharts",function(){return{template:'<div id="highcharts" style="margin: 0 auto;"></div>',scope:{option:"=",config:"="},restrict:"EA",replace:!0,link:function(e,t){$(t).width(e.config.width||0).height(e.config.height||0),e.$watch("option",function(){$("#highcharts").highcharts(e.option)},!0)}}}).directive("slideShow",["$animate",function(e){return{restrict:"A",link:function(e,t,n){e.$watch(n.slideShow,function(e){e?$(t).slideDown():$(t).slideUp()})}}}]).filter("percentage",function(){return function(e){return"number"==typeof e?100*e+"%":e}}).directive("progressBar",function(){return{template:'<div style="width: 100%;  height: 20px;  background-color: #eeefe9;  border-radius: 3px;  color: #ffffff;  display: inline-block;  overflow: hidden;  text-align: center;"><span ng-bind="config.curNum"></span>/<span ng-bind="config.totalNum"></span><div style="width: {{config.curNum / config.totalNum | percentage}}; background-color: {{config.color}}; height: 20px;  margin-top: -19px;  border-radius: 3px;"></div></div>',restrict:"E",replace:!0,scope:{config:"="}}}).controller("pdCtrl",["$scope","$routeParams","course","dialog","$timeout",function(e,t,n,a,r){function i(e){var t=[];return e&&e.forEach(function(e){t.push({click:!1,usrId:e.exam.uid||"",subTimes:e.submited||0,subStatus:200===e.exam.status,curResult:e.total||0,pubStatus:e.notp<0})}),t}function s(){var t=!1;return e.paperDetail.stdList.forEach(function(e,n){t=n?t&&e.click:e.click}),t}var o=t.pid,c=t.cid,l="null"==t.tid?"":t.tid;if(!o||!c)return a.alert("无效的试卷ID或课程ID"),void setTimeout("location.href = rcpAid.getUrl('教学中心', {token: rcpAid.getToken()}) + '#/paperManager';",2e3);e.loadPage=function(){e.pageargs={ps:10,pn:1}};var u=function(){e.searchKw="",e.clickAll=!1,e.loadPage()};e.paperDetail={detail:{},progress:{},stdList:[]},e.userList={},e.sortTypes=[{name:"提交次数",code:2,active:!1,isDescended:!0},{name:"最新成绩",code:1,active:!1,isDescended:!0}],e.sortParams=0,e.changeSelector=function(t){console.log(t),e.sortParams=t.value,console.log(e.sortParams),r(function(){e.loadPage()})},e.submitSelector={options:[{name:"全部",value:0},{name:"是",value:4},{name:"否",value:-4}],changeCb:e.changeSelector},e.publishSelector={options:[{name:"全部",value:0},{name:"未发布",value:-3},{name:"已发布",value:3}],changeCb:e.changeSelector},e.firstLoading=!1,e.showDialog=!1,e.showLoading=!1,e.clickAll=!1,e.hcOption={chart:{type:"column"},title:{text:"成绩分布图"},xAxis:{tickLength:0,tickWidth:0},yAxis:{title:{text:""},min:0,max:100,tickInterval:10},series:[{name:"人数",color:"#8dc957"}],credits:{enabled:!1},plotOptions:{line:{dataLabels:{enabled:!0}}}},e.firstLoading=!0,n.getListGroup({aid:o,ret_count:1,tid:l}).then(function(t){console.log(t);var n=[],a=[],r=t.data.count||{};for(var i in r)"avg"!=i&&"count"!=i&&"total"!=i&&r.hasOwnProperty(i)&&a.push(r[i]);for(var s=0,o=a.length,c=r.total/o;o>s;s++)n.push(c*s+"-"+c===0?"":c*(s+1)+"分");e.paperDetail.detail={paperName:t.data.title||"",answerTime:{startTime:0,endTime:0},suggestTime:+moment(t.data.ext.ext.advise_cost||0).utc().hour()+"小时"+ +moment(t.data.ext.ext.advise_cost||0).utc().hour()+"分钟",avgTime:moment(0).utc().format("HH:mm:ss"),avgScore:r.avt||0},e.hcOption.xAxis.categories=n,e.hcOption.series[0].data=a,e.firstLoading=!1},function(t){a.alert("获取统计信息错误，错误信息："+t.data.data.msg),e.firstLoading=!1}),e.pagefn=function(t,r){e.showLoading=!0,n.listPaperCorrect({aids:o,cid:c,limit:t.ps,skip:t.pn,keyword:e.searchKw,ret_answer:1,ret_score:1,sort:e.sortParams}).then(function(t){e.paperDetail.stdList=i(t.data.info||[]),e.userList=t.data.usr||{};var n=t.data.hasOwnProperty("count")&&t.data.count.hasOwnProperty("_")&&t.data.count._.hasOwnProperty(o);e.paperDetail.progress={submitProgress:{totalNum:t.data.joined||0,curNum:n?t.data.count._[o].submitted:0},correctProgress:{totalNum:n?t.data.count._[o].submitted:0,curNum:(n?t.data.count._[o].submitted:0)-(n?t.data.count._[o].notc:0)}},1!=Math.abs(e.sortParams)&&2!=Math.abs(e.sortParams)&&angular.forEach(e.sortTypes,function(e){e.active=!1}),e.showLoading=!1,r({pa:{total:n?t.data.count._[o].submitted:0}})},function(t){console.log(t),a.alert("获取试卷信息失败，错误信息："+t.data.data.dmsg),e.showLoading=!1})},e.getUserData=function(t){var n=e.userList.hasOwnProperty(t)&&e.userList[t].hasOwnProperty("attrs")&&e.userList[t].attrs.hasOwnProperty("basic")&&e.userList[t].attrs.basic.hasOwnProperty("nickName");return{nickname:n?e.userList[t].attrs.basic.nickName:""}},e.clickSort=function(t){t.active&&(t.isDescended=!t.isDescended),angular.forEach(e.sortTypes,function(e){e.active=!1}),t.active=!0,e.sortParams=t.code*(t.isDescended?-1:1),e.loadPage()},e.selectAll=function(){var t=!1;e.paperDetail.stdList.forEach(function(e){t=t||e.click}),t=t===e.clickAll?!t:t,e.clickAll=t,e.paperDetail.stdList.forEach(function(e){e.click=t})},e.selectClick=function(t){t.click=!t.click,e.clickAll=s()},e.publishResult=function(){e.selectedUid=[],e.paperDetail.stdList.forEach(function(t){t.click&&e.selectedUid.push(t.usrId)}),e.selectedUid.length?e.showDialog=!0:a.alert("请选择需要发布的学生")},e.commitPublish=function(){for(var t="",r=0,i=e.selectedUid.length;i>r;r++)t+=e.selectedUid[r]+(r===i-1?"":",");n.Publish({aid:o,tid:l,uids:t}).then(function(t){0===t.code&&a.alert("发布成功"),e.showDialog=!1,u()},function(t){a.alert("发布成绩失败，错误信息："+t.data.data.msg),e.showDialog=!1})},e.getUrl=function(e,t){t.aid=o,t.tid=l,t.cid=c;var n="";switch(e){case"批改":t.resolvestatus=2,n=rcpAid.getUrl("批改页",t);break;case"查看":t.resolvestatus=3,n=rcpAid.getUrl("批改页",t)}return n},e.enterCorrect=function(){var t="";e.paperDetail.stdList.forEach(function(e){e.click&&(t+=e.usrId+",")}),t.length&&(t=t.substring(0,t.length-1)),open(e.getUrl("批改",{tuids:t}))},e.back2PaperManager=function(){location.href=rcpAid.getUrl("教学中心",{token:rcpAid.getToken()})+"#/paperManager"},e.searchStd=function(){e.sortParams=0,e.loadPage()},e.onKeyDown=function(t){13===t.keyCode&&e.searchStd()},u()}]);